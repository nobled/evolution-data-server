2004-10-15  Chenthill Palanisamy <pchenthill@novell.com>
	
	Fixes #67031
	* backends/groupwise/e-cal-backends-groupwise-utils.c
	(e_gw_item_to_cal_component): Set the completed date. For
	posted tasks set it as the current time.
	* backends/groupwise/e-cal-backends-groupwise.c
	(e_cal_backend_groupwise_modify_object): Update the item in
	the cache after completing the task.

2004-10-14  Rodney Dawes  <dobey@novell.com>

	* backends/*/Makefile.am: Add -avoid-version to LDFLAGS for all
	of the backends

2004-10-14  Harish Krishnaswamy  <kharish@novell.com>
	* backends/groupwise/e-cal-backend-groupwise.c:
	(get_deltas) : removed stray debug code that should not have
	been there in the first place.

2004-10-12  Harish Krishnaswamy  <kharish@novell.com>
	
	Fixes #64673 and added some performance boosters.
	
	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_connection_get_freebusy_info): Resend free/busy requests 
	to server if there are outstanding users whose information is still
	pending from the server. Keep trying for 2 minutes (average time
	for obtaining the f/b information for users outside the POA).
	* backends/groupwise/e-cal-backend-groupwise.c: 
	(populate_cache):  Obtain the calendar items from server Latest First.
	Update evolution as soon as the items are processed, without waiting
	for the entire cache to be populated.
	(get_deltas): remove compiler warning.
	(cache_init): Use a marker to test the status of cache and obtain all
	items only for initial population.  All subsequent sessions would only 
	fetch the deltas from the server since the last cache modification time.
	(connect_to_server): Populating the cache moved to a separate thread
	that does not block the open calls to backend anymore.
	(e_cal_backend_groupwise_create_object): Fixed a leak.
	* libedata-cal/e-cal-backend-cache.[ch]:
	(e_cal_backend_cache_get_keys): Removed unused variable.
	(e_cal_backend_cache_set_marker),
	(e_cal_backend_cache_get_marker): Marker accessors to label the cache as
	populated or not. This helps in determining if all the items are to be 
	loaded from the server or if we should just fetch the deltas. 

2004-10-07  JP Rosevear  <jpr@novell.com>
  
  	* libecal/e-cal.c (e_cal_new_system_tasks): load the correct type
  	of events
	
2004-10-06  JP Rosevear  <jpr@novell.com>
 
 	Fixes #67513
 	
 	* libecal/e-cal.c (cal_objects_sent_cb): deep copy the user list
 	data
	
2004-10-04  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes #66484
	 idl/Evolution-DataServer-Calendar.idl (CallStatus):
	Added an error message "Unknown User".
	* libecal/e-cal-types.h (ECalendarStatus):
	Added a enum variable for the same error message
	* libecal/e-cal-listener.c (convert_status)
	* libecal/e-cal-view-listener.c (convert_status):
	Mapped the new error message.
	* libecal/e-cal.c (e_cal_get_error_message):
	Return the proper string for the new error message.

2004-10-01  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes #62868
	* e-cal-backend-groupwise-utils.c (e_gw_connection_send_appointment):
	Send the Connection Status as Ok even if we get an error message from
	the server for accepting the appointment more than once since it does
	affect the functionality.
	* e-cal-backend-groupwise.c (receive_objects):
	Return the status immediately if the Item has not been modified. Now
	the Permission Denied error message need not be sent.

2004-09-30  Chris Toshok  <toshok@ximian.com>

	* libecal/e-cal.c (get_factories): don't look for factories based
	on the supported_protocol property, since we can't use those
	anymore with dynamically loaded backends.

	* libedata-cal/e-data-cal-factory.c (get_backend_factory): rename
	get_backend_type to this, and return an ECalBackendFactory*
	instead of a GType.
	(impl_CalFactory_getCal): change this code to use
	ECalBackendFactory.
	(e_data_cal_factory_register_backend): rename from
	e_data_cal_factory_register_method and remove all the args, just
	passing an ECalBackendFactory.
	(e_data_cal_factory_register_backends): register all extensions
	that subclass from E_TYPE_CAL_BACKEND_FACTORY.

	* libedata-cal/e-data-cal-factor.h: change prototypes and function
	names.
	
	* libedata-cal/e-data-cal.[ch] (e_data_cal_new): remove the @uri
	arg, as it's unnecessary.

	* libedata-cal/e-cal-backend-factory.[ch]: superclass the backend
	factories must subclass from.

	* libedata-cal/Makefile.am (libedata_cal_la_SOURCES): add
	e-cal-backend-factory.c
	(libedata_calinclude_HEADERS): add e-cal-backend-factory.h

	* backends/contacts/Makefile.am (extension_LTLIBRARIES): change
	from noinst_LTLIBRARIES.
	(libecalbackendcontacts_la_SOURCES): add
	e-cal-backend-contacts-factory.[ch].

	* backends/contacts/e-cal-backend-contacts-factory.[ch]:
	ECalBackendFactory for the contacts backend.

	* backends/file/Makefile.am (extension_LTLIBRARIES): change
	from noinst_LTLIBRARIES.
	(libecalbackendfile_la_SOURCES): add
	e-cal-backend-file-factory.[ch].

	* backends/file/e-cal-backend-file-factory.[ch]:
	ECalBackendFactory for the file backend.

	* backends/groupwise/Makefile.am (extension_LTLIBRARIES): change
	from noinst_LTLIBRARIES.
	(libecalbackendgroupwise_la_SOURCES): add
	e-cal-backend-groupwise-factory.[ch].

	* backends/groupwise/e-cal-backend-groupwise-factory.[ch]:
	ECalBackendFactory for the groupwise backend.

	* backends/http/Makefile.am (extension_LTLIBRARIES): change
	from noinst_LTLIBRARIES.
	(libecalbackendhttp_la_SOURCES): add
	e-cal-backend-http-factory.[ch].

	* backends/http/e-cal-backend-http-factory.[ch]:
	ECalBackendFactory for the http backend.
	
2004-09-28  Rodrigo Moya <rodrigo@novell.com>

	Fixes #66230

	* backends/http/e-cal-backend-http.c (retrieval_done): do a more clever
	update of the cache, so that we correctly notify listeners of updates,
	additions and removals.

2004-09-24  JP Rosevear  <jpr@novell.com>

	Fixes #66383, From David Malcolm <dmalcolm@redhat.com>
	
	* libecal/e-cal.c (e_cal_get_alarms_in_range): return non void
	values

	* libecal/e-cal-component.c: kill warnings about struct
	definitions
	
2004-09-24  JP Rosevear  <jpr@novell.com>
	
	Fixes #64955, Vincent Noel <vnoel@cox.net>
	
	* libecal/e-cal.c (e_cal_get_alarms_in_range): fix c99-ism
	
2004-09-23  Rodrigo Moya <rodrigo@novell.com>

	Fixes #59904

	* libecal/e-cal-component.[ch] (e_cal_component_new_from_string): new
	function to avoid repeating the same code over and over.

	* libedata-cal/e-data-cal-view.c: changed to keep a list of listeners,
	not only one.
	(listener_died_cb): remove the listener from the list of listeners.
	(impl_EDataCalView_start): see if the query has already been started,
	and if so, just notify correctly the listeners we need to notify.
	(e_data_cal_view_init): create hash table for storing the objects we
	have matching the live query.
	(e_data_cal_view_set_property): add correctly the listeners to the list.
	(e_data_cal_view_get_property): return always the first listener.
	(e_data_cal_view_finalize): free all listeners and cached objects.
	(add_object_to_cache, remove_object_from_cache):
	new functions to manage the matched objects cache.
	(e_data_cal_view_notify_objects_added,
	e_data_cal_view_notify_objects_modified): add objects to our private
	cache, and notify all listeners, now that we might have more than one.
	(e_data_cal_view_notify_objects_removed,
	e_data_cal_view_notify_progress, e_data_cal_view_notify_done): notify
	all listeners.
	(e_data_cal_view_add_listener, e_data_cal_view_get_matched_objects,
	e_data_cal_view_is_started, e_data_cal_view_is_done,
	e_data_cal_view_get_done_status): new functions.

	* libedata-cal/e-data-cal.c: keep a cache of all queries.
	(impl_Cal_getQuery): first look in the cache of queries. And when
	creating a new query, add it to the cache.
	(impl_Cal_getObjectList): use the query cache also.
	(e_data_cal_finalize): destroy the live queries hash table.
	(e_data_cal_init): create live queries hash table.

2004-09-23  JP Rosevear  <jpr@novell.com>

	* libecal/Makefile.am: build a versioned lib, don't hard
	code the pkgconfig version

	* libedata-cal/Makefile.am: ditto
	
	* backends/file/Makefile.am: link against the correct library version
	
	* backends/http/Makefile.am: ditto

	* backends/groupwise/Makefile.am: ditto

	* backends/contacts/Makefile.am: ditto

	* tests/ecal/Makefile.am: ditto
	
2004-09-22  Harish Krishnaswamy  <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.[ch]:
	(e_gw_connection_send_appointment): Allow callers to get the 
	sent item from the server to ensure the iCalId of the component
	is in sync with the server - even if it had been obtained from
	a different client via itip.
	(e_gw_item_to_cal_component) : additional check to ensure icalid
	is not null in the item, so we would not crash against server instances
	that may not send this properly.

	Fixes #61865	
	* backends/groupwise/e-cal-backend-groupwise.c: 
	(get_deltas) : Replace getDeltasRequest by getQuickMessages calls
	and compute deltas like adds, modify and deletes.
	(connect_to_server): Do not recreate cache everytime and use the 
	getQuickMessages to pull in the changes from server. The existing
	code was a work-around till this fix was in place.

	(e_cal_backend_groupwise_create_object), (receive_object):
	Use the modified  e_gw_connection_send_appointment calls and
	update the cache and cal clients appropriately.

	* libedata-cal/e-cal-backend-cache.[ch]:
	(e_cal_backend_cache_get_keys): Adding a function that allows to 
	retrieve a list of the keys of all components from the cache.
	

2004-09-08  Chenthill Palanisamy <pchenthill@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(set_properties_from_cal_component), (e_gw_item_to_cal_component),
	(e_gw_item_set_changes): Added the support for allday events.

2004-09-08  Chenthill Palanisamy <pchenthill@novell.com>
	
	Fixes #65167
	* backends/groupwise/e-cal-backend-groupwise.c 
	(connect_to_server): Reload the default zone into
	the cache after clearing it.

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(set_categories_for_gw_item), e_gw_item_to_cal_component),
	(set_properties_from_cal_component): replaced the assert
	statements with If conditions.

2004-09-07  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes #64685
	* backends/groupwise/e-cal-backends-groupwise.c
	(receive_object): Send the error message as 
	Permission Denied when the attendee tries to accept the 
	appointment more than once since we get the error message as
	bad parameter from the server.

2004-09-07  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes 63513
	* backends/groupwise/e-cal-backends-groupwise-utils.c
	(e_gw_connection_send_appointment): Do a case insensitive
	comparison between the email ids. This is a partial fix.

2004-09-07  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes #64398
	* backends/groupwise/e-cal-backend-groupwise.c
	(ECalBackendGroupwisePrivate): added an variable to store 
	the timeout ids.
	(e_cal_backend_groupwise_init): intialize the variable.
	(e_cal_backend_groupwise_finalize): remove the timeout_add
	function so that it will not called when backend dies.
	(get_deltas): It should not crash in any case if handle is
	NULL.

2004-09-05  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes 63513
	* backends/groupwise/e-cal-backends-groupwise-utils.c
	(e_gw_connection_send_appointment): Do a case insensitive
	comparison between the email ids.
	
2004-09-05  Chenthill Palanisamy <pchenthill@novell.com>
	
	* libecal/e-cal-utils.h:
       	defined two macros for the handling the static capabilities for 
	backends which does not support the conversion of a non-recurring
	appointment to a recurrence appointment and conversion of posted
	task to group task.
	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_get_static_capabilities): Added the 
	two macros in this function.

2004-09-05  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes #64688
	* backends/groupwise/e-cal-backend-groupwise.c
	(connect_to_server): store the default zone in
	backend before populating the cache.
	
2004-08-27  Rodrigo Moya <rodrigo@novell.com>

	* libedata-cal/e-cal-backend-sexp.c (func_has_alarms_in_range): new
	function for the regular expression language.
	(e_cal_backend_sexp_new): added new function to the list of symbols.

	* libecal/e-cal.c (e_cal_get_alarms_in_range): use the new
	'has-alarms-in-range' function.

2004-08-27  Chenthill Palanisamy <pchenthill@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(set_properties_from_cal_component): set the acceptLevel
	for the appointment as Free if its not Busy.

2004-08-26  Rodrigo Moya <rodrigo@novell.com>

	* libecal/e-cal-util.c (check_instance): match the prototype expected
	in icalcomponent_foreach_recurrence.
	(e_cal_util_remove_instances): fixed warning.

2004-08-25  Frederic Crozat  <fcrozat@mandrakesoft.com>

	* libecal/e-cal.c: (e_cal_set_default_timezone):
	Need a return value.

2004-08-25  Chenthill Palanisamy <pchenthill@novell.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(populate_cache): Used a static mutex to avoid the 
	the simulataneous calls from calendar and tasks to
	ReadCursorRequest which crashes the server.

2004-08-24  Sivaiah Nallagatla <snallagatla@novell.com>

	* backends/groupwise/e-cal-backend-groupwise.c 
	(populate_cache) : use cursor methods to get items in chunks instead of 
	getting all at once

2004-08-24  Chenthill Palanisamy <pchenthill@novell.com>
         
	* backends/groupwise/e-cal-backend-groupwise.c
	(receive_object): update the client view when a meeting
	is accepted or declined.

2004-08-23  Chenthill Palanisamy <pchenthill@novell.com>
	
	Fixes bug #62857
	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object): return	the cal object created
	for the first component and notify the client for the cal objects of other 
	components created in recurrences.

2004-08-17  Rodrigo Moya <rodrigo@novell.com>

	Fixes #61782

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_create_object):
	allow iCalendar objects with no UID.

2004-08-17  JP Rosevear  <jpr@novell.com>

	* libecal/e-cal.c (e_cal_set_default_timezone): don't set the same
	time to the server again, avoids a needless server hit

2004-08-17  Chenthill Palanisamy <pchenthill@novell.com>
	
	* backends/groupwise/e-cal-backend-groupwise.c
	(connect_to_server): Clear the cache before populating 
	it.

2004-08-16  Chenthill Palanisamy <pchenthill@novell.com>
	
	* backends/groupwise/e-cal-backend-groupwise.c
	(connect_to_server): Do not get the items from server every time 
	the calendar is loaded, since the cache is already populated. 

2004-08-13  Hans Petter Jansson  <hpj@ximian.com>

	Fixes bug #62655.

	* backends/contacts/e-cal-backend-contacts.c (source_group_added_cb):
	If source group's URI is NULL, do nothing, i.e. don't crash.

2004-08-13  Chenthill Palanisamy <pchenthill@novell.com>

        * backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_item_to_cal_component): handle the BC recipient type
         with TO and CC.	

2004-08-12  Not Zed  <NotZed@Ximian.com>

	* libecal/e-cal.c (async_auth_func_cb): removed.
	(open_async): dont override the auth callback.  It is now up to
	the caller to ensure they're thread-safe and serialised
	appropriately.

2004-08-12  Rodrigo Moya <rodrigo@novell.com>

	* libecal/e-cal.c (e_cal_remove_object, e_cal_receive_objects):
	added missing gtk-doc comments.

2004-08-09  Jeffrey Stedfast  <fejj@novell.com>

	Fixes bug #58150

	* libecal/e-cal.c (e_cal_activate): init bonobo if it isn't
	already initialised.
	(e_cal_new): Call e_cal_activate().

2004-08-09  Harish Krishnaswamy  <kharish@novell.com>

	Fixes #58643 - the gw backend assembles the xgwrecordid
	to be used for accept/decline requests.

	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_connection_send_appointment): use the event and todo type
	markers while assembling the gwrecordid from the itip message.
	set flag 'remove' for decline/retract requests to indicate 
	these should be removed from cache.
	* backends/groupwise/e-cal-backend-groupwise-utils.h:
	Add parameter to e_gw_connection_send_appointment and define macros
	GW_EVENT_TYPE_ID and GW_TODO_TYPE_ID.
	* backends/groupwise/e-cal-backend-groupwise.c: (receive_object):
	update the cache based on the remove flag set by 
	e_gw_connection_send_appointment.

2004-08-04  Chenthill Palanisamy <pchenthill@novell.com>

       Fixes #60265
       * backends/groupwise/e-cal-backend-groupwise.c
       (e_cal_backend_groupwise_open): Whenever open_method is called
       get the data from the server and populate the cache.

2004-08-03  Harish Krishnaswamy  <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_connection_send_appointment): Add ':' as a separator
	while appending the container id to the xgwrecordid to
	generate the item_id.

2004-08-02  Not Zed  <NotZed@Ximian.com>

	** See bug #58642.

	* libedata-cal/e-data-cal-factory.c (backend_last_client_gone_cb):
	the table key includes the kidn for some reason.
	(impl_CalFactory_getCal): store the icalkind in the uri, not the
	calobjtype.  Fix a memory leak.

2004-08-02  Chenthill Palanisamy <pchenthill@novell.com>
	
	Fixes #57127
	* backends/groupwise/e-cal-backend-groupwise.c:
	(ECalBackendGroupwisePrivate): Added two hash tables
	for the category ids and names.
	(e_cal_backend_groupwise_get_connection), 
	(e_cal_backend_groupwise_get_default_zone), 
	(e_cal_backend_groupwise_get_categories_by_id),
	(e_cal_backend_groupwise_get_categories_by_name):
	Added to access the ECalBackendGroupwisePrivate structure.
	* backends/groupwise/e-cal-backend-groupwise-utils.c: 
	(e_gw_item_new_from_cal_component), (e_gw_item_to_cal_component),
	(e_gw_connection_create_appointment), (set_properties_from_cal_component):
	Changed the argument from icaltimezone to ECalBackendGroupwise to 
	access ECalBackendGroupwisePrivate structure for storing categories 
	to calendar components.
	(set_categories_for_gw_item): Added to store the categories in GW item.
	(set_categories_changes): Added to update the category changes.

2004-07-30  Harish Krishnaswamy  <kharish@novell.com>
	
	Fixes #59335
	
	* libecal/e-cal.c: (open_calendar): Set the status correctly
	on all exit points from the function.

2004-07-28  Chenthill Palanisamy <pchenthill@novell.com>

	Fixes #60265
	* backends/groupwise/e-cal-backend-groupwise.c
	(connect_to_server), (e_cal_backend_groupwise_open):
	Creates the cache structure after connecting to server and loads 
	the default timezone after populating the cache.

2004-07-26  Harish Krishnaswamy  <kharish@novell.com>

	Fixes #57651, #58637 and #58643
	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_connection_send_appointment) : Append the container id to
	the gwrecordid obtained via ITIP to match the representation 
	in the SOAP interface.
	(e_gw_item_set_changes): Updates to 'completed' field in the Task
	is not sticky in the server, when using the modifyRequest. Using a 
	separate completeRequest call to update the same.
	* backends/groupwise/e-cal-backend-groupwise-utils.h: removed the
	unused default_zone parameter from e_gw_connection_send_appointment.
	* backends/groupwise/e-cal-backend-groupwise.c: 
	(get_deltas): return boolean values not the connection status as the 
	caller is not expected to handle it anyway.
	(sanitize_component): renamed set_container_id function, so it
	correctly depicts what it does.
	(e_cal_backend_groupwise_create_object): Make a getItemsRequest to the 
	server to obtain the items while creating recurring events. The original
	call returns only the item ids and the client requires the icalids too
	to keep the cache valid.
	(e_cal_backend_groupwise_modify_object) : Use the completeRequest method
	to update task completion. 
	(receive_object) : The call to e_gw_connection_send_appointment updated
	to reflect the change in its signature. 
	(e_cal_backend_groupwise_receive_objects): set the method on the subcomp
	created before passing it over to receive_object.

2004-07-23  Chenthill Palanisamy <pchenthill@novell.com>
	
	Fixes #60463
	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_connection_get_freebusy_info):
	Added a timezone  argument and used it to convert the freebusy 
	times to default timezone. (Have added the patch again since it was inadvertently removed from 
	by some commit)
	
2004-07-15  JP Rosevear  <jpr@novell.com>

	Fixes #58748
	
	* backends/contacts/e-cal-backend-contacts.c (cdate_to_icaltime):
	explicitly set is_utc and set zone to NULL
	(create_component): use NULL instead of 0
	(e_cal_backend_contacts_set_default_timezone): fix logic typo so
	that the default zone is set correctly

2004-07-15  Rodrigo Moya <rodrigo@novell.com>

	Fixes #57142

	* libecal/e-cal-component.c (ensure_alarm_properties_cb): add the
	X-EVOLUTION-NEEDS-DESCRIPTION property to the alarms we create
	with no description, and remove the property from the alarms with
	a description already.

	(e_cal_component_set_summary, set_alarm_description_cb): set the
	description on the alarms when the summary changes and remove the
	above property when we set a valid description.

2004-07-14  Chenthill Palanisamy <pchenthill@novell.com>

       Fixes #60344
       * backends/groupwise/e-cal-backend-groupwise.c:
       (e_cal_backend_groupwise_internal_get_timezone):
       Send the timezone present in tzid instead of sending UTC timezone.

2004-07-12  Harish Krishnaswamy  <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_cal_component_get_gw_id): Access method for getting the 
	XGWRECORDID property from the calendar component.
	(set_properties_from_cal_component): Range of priority value
	HIGH extended to include values 1 and 2.
	The X-EVOLUTION-GROUPWISE-ID is now referred as XGWRECORDID
	for consistency with the ITIP messages.
	(e_gw_item_to_cal_component) : Absence of due_date does not 
	invalidate the task component. Fixes #60926.
	(e_gw_connection_send_appointment),(e_gw_connection_create_appointment):
	Implemented.
	(e_gw_connection_get_freebusy_info):
	(e_gw_item_set_changes): Fixed compiler warnings.
	
	* backends/groupwise/e-cal-backend-groupwise-utils.h:
	Declarations for added functions.
	* backends/groupwise/e-cal-backend-groupwise.c: 
	(populate_cache) : Removed unused variables.
	(set_container_id): Extracted a function out of the code as it is
	used twice.
	(e_cal_backend_groupwise_create_object): Handle changes in the SOAP interface.
	The server now returns 	a list of uids. This is to allow creation of recurring 
	calendar events.
	(e_cal_backend_groupwise_modify_object): Fix some leaks.
	(e_cal_backend_groupwise_remove_object), (receive_object),
	(send_object), (e_cal_backend_groupwise_send_objects): Use the newly created
	functions for handling group calendar items.

2004-07-12  Sivaiah Nallagatla   <snallagatla@novell.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(form_uri) : read "use_ssl" property from the ESource
	and form the uri accordingly
	(connect_to_server) : when "use_ssl" is "when-possible"
	try with https first and then with http if that fails

2004-06-28  Chenthill Palanisamy <pchenthill@novell.com>
	
	Fixes #60463
	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_connection_get_freebusy_info):
	Added a timezone  argument and used it to convert the freebusy 
	times to default timezone.

2004-06-15  Harish Krishnaswamy  <kharish@novell.com>

	Fixes #59352	
	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(set_properties_from_cal_component), (e_gw_item_to_cal_component):
	Handle the organizer property of ecal and allow storing to and 
	from e-gw-item.

2004-06-14  Rodrigo Moya <rodrigo@novell.com>

	Fixes #57088

	* backends/contacts/e-cal-backend-contacts.c (source_group_added_cb):
	only add sources from local addressbook backends.

2004-06-14  Harish Krishnaswamy  <kharish@novell.com>


	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(get_recur_instance), (resolve_tzid_cb) : add support for recurrences 
	in events.
	(set_properties_from_cal_component), (e_gw_item_to_cal_component),
	(e_gw_item_set_changes): Recipient_list handling code is now common to
	both events and todos.
	* backends/groupwise/e-cal-backend-groupwise.c: (populate_cache): Add
	recipientStatus to the view element.
	(receive_object): Send found_comp as argument to modify_object.

2004-06-11  Rodrigo Moya <rodrigo@novell.com>

	* libedata-cal/e-cal-backend-sync.c (_e_cal_backend_remove_object): if
	the deletion is successful, check if the object still exists, in which
	case it means we removed an instance of a recurring event. Fixed
	memory leak also.

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_remove_object):
	return the old_object output argument in all cases.

2004-06-02  Rodrigo Moya <rodrigo@novell.com>

	* libecal/e-cal.c (e_cal_generate_instances,
	e_cal_generate_instances_for_object, e_cal_get_alarms_in_range,
	e_cal_get_alarms_for_object): only allow values from 0 to time_t's
	maximum value.

	* libecal/e-cal.h: added missing prototype.

2004-06-01  Rodrigo Moya <rodrigo@novell.com>

	* libecal/e-cal.c (e_cal_generate_instances): moved all the logic...
	(generate_instances): ...here, so that we can specify a UID to
	generate instances only for that UID.
	(e_cal_generate_instances_for_object): use generate_instances
	function and specify the UID of the object.

	* libedata-cal/e-cal-backend-sexp.c (e_cal_backend_sexp_match_comp):
	added checks for arguments.

2004-06-01  Rodrigo Moya <rodrigo@novell.com>

	* libecal/e-cal.c (e_cal_generate_instances_for_object,
	e_cal_generate_instances): allow -1 for the start and end times.
	(load_static_capabilities, add_instance): fixed warnings.

2004-06-01  JP Rosevear  <jpr@novell.com>

	* libecal/*: revert accidental commit

2004-05-28  JP Rosevear  <jpr@novell.com>

	Fixes #55524
	
	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_receive_objects): don't sanitize the
	component, we already check for valid timezones and the zones
	aren't merged in yet anyhow

2004-05-28  Rodrigo Moya <rodrigo@novell.com>

	* libedata-cal/e-data-cal-factory.c (backend_last_client_gone_cb):
	disconnect from signals on the removed backend.

2004-05-28  Harish Krishnaswamy  <kharish@novell.com>


	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(e_gw_item_to_cal_component): Throw in null checks on 
	mandatory fields to bypass crashes in e-d-s while the server 
	gets fixed.


2004-05-27  Rodrigo Moya <rodrigo@novell.com>

	* backends/http/e-cal-backend-http.c (retrieval_done): make sure
	we clean up the cache, or old events will always be kept.

2004-05-27  Rodrigo Moya <rodrigo@novell.com>

	Fixes #58197

	* libedata-cal/e-cal-backend.c (e_cal_backend_create_object,
	e_cal_backend_modify_object): removed assertions on method
	implementations, since backends can perfectly have unimplemented
	methods. Instead, notify the error.

2004-05-25  Sivaiah Nallagatla <snallagatla@novell.com>

        * backends/groupwise/e-cal-backends-groupwise.c (form_uri) :
        new function to form the uri required for e_gw_connection
         (connect_to_server) : use form_uri instead of convert_uri

2004-05-25  Harish Krishnaswamy  <kharish@novell.com>

	Fixes GW portion of #57218 and #54280

	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(start_freebusy_session): removed FIXME comments (the code had been 
	fixed much earlier).
	(e_gw_item_set_changes):use the SET_DELTA macro to get accept_level 
	changes.
	* backends/groupwise/e-cal-backend-groupwise.c:
	(e_cal_backend_groupwise_modify_object),
	(e_cal_backend_groupwise_remove_object),
	(e_cal_backend_groupwise_send_objects): set return arguments correctly.
	and removed dead code in remove_object.

2004-05-25  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_modify_object): return ObjectNotFound error
	instead of InvalidObject when the object is not found.

2004-05-22  Rodrigo Moya <rodrigo@ximian.com>

	* backends/file/e-cal-backend-file.c (add_component): make sure we
	process correctly the detached instances.
	(match_object_sexp): deal with hash table entries not containing
	a full_object (ie, detached recurrences).

2004-05-21  JP Rosevear  <jpr@novell.com>

	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_receive_objects): make sure we only handle the
	type of objects the backend is set up for plus timezones; directly
	add the objects rather than using other functions

2004-05-19  Chris Toshok  <toshok@ximian.com>

	* backends/contacts/e-cal-backend-contacts.c (book_record_new):
	use new e_book_new/e_book_open apis.

2004-05-19  Rodrigo Moya <rodrigo@ximian.com>

	Removes 100s of error dialogs as reported in #54211

	* backends/http/e-cal-backend-http.c: added a flag to know when the
	backend has been opened.
	(reload_cb): set the "opened" flag to TRUE when we reload.
	(retrieval_done): only notify errors when opening the backend, not
	on each reload, or we'll get many error message dialogs when left
	running for a few hours.

2004-05-18  Harish Krishnaswamy  <kharish@novell.com>

	Fixes #56320 and related timezone issues.
	Convert datetime from the Groupwise string format between icaltime
	directly w/o using time_t structures.
	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(set_properties_from_cal_component),
	(e_gw_item_new_from_cal_component), (e_gw_item_to_cal_component),
	(e_gw_connection_send_appointment), (e_gw_item_set_changes):
	use the default_timezone info while performing the conversions.
	* backends/groupwise/e-cal-backend-groupwise-utils.h:
	* backends/groupwise/e-cal-backend-groupwise.c: (populate_cache),
	(get_deltas), (connect_to_server),
	(e_cal_backend_groupwise_finalize), (e_cal_backend_groupwise_open),
	(e_cal_backend_groupwise_add_timezone):
	Add timezone to the cache and allow evolution to set the default timezone.
	(e_cal_backend_groupwise_set_default_timezone),
	(e_cal_backend_groupwise_create_object),
	(e_cal_backend_groupwise_modify_object), (receive_object),
	(send_object), (e_cal_backend_groupwise_init):
	* libedata-cal/e-cal-backend-cache.c:
	(e_cal_backend_cache_put_default_timezone),
	(e_cal_backend_cache_get_default_timezone):
	Store default timezone information in the cache so that eds remembers the
	client timezone information while populating the cache in the next session.
	Since the cache population happens while the calendar is still loading, evolution
	would not have had a chance to set the timezone yet.
	
	* libedata-cal/e-cal-backend-cache.h: Added get/put functions for
	default timezone.

2004-05-18  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c (func_occur_in_time_range): always
	use a valid timezone.

	* libecal/e-cal-recur.c (cal_object_time_from_time): don't use invalid
	timezones.

	* libecal/e-cal.c (e_cal_generate_instances): make sure we always have
	a default timezone.

2004-05-17  Rodney Dawes  <dobey@ximian.com>

	* libecal/Makefile.am (libecal_la_LIBADD):
	* libedata-cal/Makefile.am (libedata_cal_la_LIBADD):
	Add $(EVOLUTION_CALENDAR_LIBS) to link to all the right dependencies
	so that the mono bindings will work correctly

	Fixes #58615

2004-05-17  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #51412

	* backends/file/e-cal-backend-file.c (remove_instance): re-add the
	modified objects to the top-level icalcomponent after removing
	instances.
	(e_cal_backend_file_remove_object): manage the CALOBJ_MOD_THIS case
	for an event with no RECURRENCE-ID.

2004-05-14  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #56870

	* libedata-cal/e-cal-backend-sync.c (e_cal_backend_sync_create_object,
	e_cal_backend_sync_modify_object, e_cal_backend_sync_remove_object,
	e_cal_backend_sync_discard_alarm, e_cal_backend_sync_receive_objects,
	e_cal_backend_sync_send_objects): don't g_assert if the method is not
	implemented on the underlying backend, just return an UnsupportedMethod
	error.

2004-05-14  Rodrigo Moya <rodrigo@ximian.com>
	
	* libedata-cal/e-cal-backend-sexp.c (e_cal_backend_sexp_func_make_time):
	added extra check for function arguments.

	* libedata-cal/e-cal-backend-cache.c (e_cal_backend_cache_put_timezone):
	added missing implementation from recurreces-work-branch.

	* libecal/e-cal-recur.c (e_cal_recur_generate_instances_of_rule):
	use the default timezone if we can't get timezones for the start
	and end dates.

2004-05-13  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #54094

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_modify_object):
	deal correctly with CALOBJ_MOD_THIS for master objects.

2004-05-12  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (e_cal_generate_instances): fixed gtk-doc comments,
	and process correctly detached instances.
	(e_cal_generate_instances_for_object): new function.
	(e_cal_set_default_timezone): set the internal default timezone when
	the call to the backend is successful.
	(process_detached_instances): process correctly the detached instances.

2004-05-12  Harish Krishnaswamy  <kharish@novell.com>


	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(set_properties_from_cal_component), (e_gw_item_to_cal_component),
	(e_gw_connection_get_freebusy_info), (e_gw_item_set_changes):
	Add implementation for modification of objects.
	* backends/groupwise/e-cal-backend-groupwise-utils.h:
	Add declaration for e_gw_item_set_changes.	
	* backends/groupwise/e-cal-backend-groupwise.c:
	(e_cal_backend_groupwise_set_default_timezone):
	Allow evo to set the timezone in the groupwise backend.
	(e_cal_backend_groupwise_modify_object):
	Modify implementation to use modifyItemRequest rather than
	a sendItem.

2004-05-07  JP Rosevear  <jpr@ximian.com>

	Fixes #57908
	
	* libecal/e-cal-component.c (e_cal_component_set_organizer):
	prevent double frees
	(e_cal_component_set_organizer): ditto
	(e_cal_component_set_summary): ditto

2004-05-06  Harish Krishnaswamy  <kharish@novell.com>

	* libecal/e-cal.c: (load_static_capabilities): assign capabilities
	to ecal->capabilities so that it need not be computed repeatedly.
	* backends/groupwise/e-cal-backend-groupwise.c: 
	(populate_cache) : added message to view element to recieve 
	message bodies as plain text (default).
	(connect_to_server) : the Tasks folder is also Calendar and 
	not Checklist in GW server.
	(e_cal_backend_groupwise_get_static_capabilities) :
	Added CAL_STATIC_CAPABILITY_SAVE_SCHEDULES.

2004-05-04  Harish Krishnaswamy  <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(set_properties_from_cal_component),
	(e_gw_item_new_from_cal_component), (e_gw_item_to_cal_component):
	Patch the FIXMEs in the code handling recipient_list and message bodies
	in events. This also resolves #57204 and 57883.
	
	
2004-05-03  William Jon McCann  <mccann@jhu.edu>

	* libecal/e-cal-time-util.h: Add missing G_BEGIN_DECLS and G_END_DECLS

2004-05-04  Harish Krishnaswamy  <kharish@novell.com>

	Fixes #55922
	
	* libedata-cal/e-data-cal-factory.c: (impl_CalFactory_getCal):
	Hash the backends based on the uri 'and' the type (Both calendar
	and tasks for GW share the same uri but need different e-data-cal
	instances.

2004-05-03  JP Rosevear  <jpr@ximian.com>

	Partial fix for #57218
	
	* libecal/e-cal.c (cal_objects_sent_cb): copy the object string
	(e_cal_get_default_object): check the status explicitly
	(e_cal_get_object): ditto
	(e_cal_get_timezone): ditto
	(e_cal_send_objects): parse the string here so we can handle bad
	parsing properly

	* libecal/e-cal-marshal.list: replace marshaller signature

	* libecal/e-cal-listener.h: update signal proto

	* libecal/e-cal-listener.c (impl_notifyObjectsSent): send back
	just the text like other similar routines
	(e_cal_listener_class_init): send back a string as the third arg
	in the send_objects signal

2004-04-30  Dan Winship  <danw@ximian.com>

	* libecal/e-cal-component.c (get_attendee_list): Fill in some
	default values to avoid libical assertions later. Also, fix some
	really awful cut+pastos

2004-04-28  JP Rosevear  <jpr@ximian.com>

	* tests/ecal/test-search.c: something to run searches with for
	test purposes

	* tests/ecal/Makefile.am: build test search 

2004-04-28  JP Rosevear  <jpr@ximian.com>

	Fixes #57080
	
	* libedata-cal/e-cal-backend.c
	(e_cal_backend_notify_object_modified): make sure the item was
	actually in the query before so we don't send bogus removes

2004-04-27  Harish Krishnaswamy  <kharish@novell.com>

	Fixes #56535

	* backends/groupwise/e-cal-backend-groupwise-utils.c:
	(set_properties_from_cal_component), (e_gw_item_to_cal_component):
	Added support for saving Alarms in the GW server as well as 
	read the alarm information during retrieval.


2004-04-23  Jeffrey Stedfast  <fejj@ximian.com>

	* libedata-cal/e-data-cal.c (e_data_cal_notify_changes): Fixed a
	c/p bug. Don't call notifyDefaultTimezoneSet, we want to
	notifyChanges! Took me long enough to track this little bugger
	down.

2004-04-21  Jeffrey Stedfast  <fejj@ximian.com>

	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_receive_objects): Pass the address of calobj
	to file_create_object().
	(e_cal_backend_file_compute_changes): "Gracefully" handle a NULL
	return from e_xmlhash_new().

2004-04-20  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c (open_async): emit the open signal in an idle
	loop
	(async_signal_idle_cb): emit the signal and free the data

2004-04-16  Harish Krishnaswamy  <kharish@novell.com>
	
	Fixes #55802
	
	* libecal/e-cal.c: (open_calendar): Create and lock
	op mutex and unlock ecal before attempting to authenticate.
	(open_async, async_auth_idle_cb,async_auth_func_cb): implement 
	async authentication to calendar.
	

2004-04-15  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_add_timezone): do a little more sanity
	checking on what we send

2004-04-12  Sarfraaz Ahmed <asarfraaz@novell.com>

	Fixes #56517
                                                                                
        * libecal/e-cal.c (e_cal_add_timezone): Added a check for icalcomponent
        structure. Return FALSE if icalcomponent is NULL.

2004-04-12  Harish K <kharish@novell.com>

	Fixes #53926
	
	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(e_gw_item_to_cal_component) : set the tzid to "UTC"
	while setting the dueDate.
		
	
2004-04-08  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_get_static_capabilities): add the 
	ONE_ALARM_ONLY static capability.

2004-04-06  Harish K <kharish@novell.com>
	
	Fixes #55169

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(e_gw_connection_get_freebusy_info) : Use icalproperty
	to add free/busy data to ECalComponent.
	
2004-04-05  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove_object): Use correct types for
	e_cal_backend_groupwise_get_object's return value.

2004-04-03  JP Rosevear  <jpr@ximian.com>

	Fixes #56416
	
	* backends/contacts/e-cal-backend-contacts.c
	(e_cal_backend_contacts_get_timezone): implement
	(e_cal_backend_contacts_add_timezone): ditto
	(e_cal_backend_contacts_set_default_timezone): ditto
	(free_zone): free a timezone
	(e_cal_backend_contacts_finalize): destroy the zones hash table
	(e_cal_backend_contacts_class_init): add new method
	implementations
	(e_cal_backend_contacts_init): set up zones hash table

2004-04-02  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #51412

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_remove_object):
	support being called with CALOBJ_MOD_THIS on the top level component.

2004-04-02  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #55719

	* backends/groupwise/e-cal-backend-groupwise.c (connect_to_server):
	use correct type for populate_cache's return value.
	(e_cal_backend_groupwise_set_mode): use correct type for
	connect_to_server's return value.

2004-03-30  JP Rosevear <jpr@ximian.com>

	* backends/file/e-cal-backend-file.c: allow debugging code to be
	turned on and off easily

	* backends/http/e-cal-backend-http.c: ditto
	
2004-03-31  JP Rosevear <jpr@ximian.com>

	Fixes #56111
	
	* backends/contacts/e-cal-backend-contacts.c (create_component):
	take a uid for the icalcomp
	(create_birthday): create a uid from the contact uid and a
	birthday designator
	(create_anniversary): ditto for anniversary
	(e_cal_backend_contacts_get_cal_address): set the address to NULL
	when returning success
	(e_cal_backend_contacts_get_ldap_attribute): ditto for the
	attribute
	(e_cal_backend_contacts_remove): can't remove a read only calendar
	(e_cal_backend_contacts_get_object): implement
	
2004-03-31  JP Rosevear <jpr@ximian.com>

	Fixes #54713
	
	* libecal/e-cal.c (e_cal_get_object): only try to parse the string
	if the status is good
	(e_cal_get_timezone): ditto
	(e_cal_get_default_object): ditto
	
2004-03-29  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (e_cal_generate_instances): added support for dealing
	with detached instances.
	(process_detached_instances): replace all generated instances with the
	detached ones.

2004-03-29 Harish K <kharish@novell.com>

	* backends/groupwise/e-cal-backend-utils.c 
	(start_freebusy_session) : send UTC time to server instead of
	floating time. remove namespaces to elements in request messages.
	(e_gw_connection_get_freebusy_info) :send f/b information thro'
	ECalComponentAttendee structure -not ECalComponentOrganizer.
	
2004-03-26  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: add proto
	
	* libecal/e-cal.c (e_cal_get_source_type): accessor

2004-03-26  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object): replace the inbox container ID
	in the ID returned by sendItemResponse with our container ID.
	(e_cal_backend_groupwise_remove_object): if the object does not have the
	GW server ID, use the iCalID property to remove it.

2004-03-26  Rodrigo Moya <rodrigo@ximian.com>
	
	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(e_gw_connection_send_appointment): set the container ID on the
	EGwItem returned by e_gw_item_new_from_cal_component.

2004-03-25  William Jon McCann  <mccann@jhu.edu>

	* backends/http/e-cal-backend-http.c (retrieval_done):
	(e_cal_backend_http_get_default_object): use the same component
	kind as the backend.

2004-03-25  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object): add the X-EVOLUTION-GROUPWISE-ID
	property to the newly-created component.

2004-03-25  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-sync.[ch]
	(e_cal_backend_sync_create_object): made the 'calobj' argument to
	be inout, so that the caller gets the modified component, not the
	original one sent to the backend.
	(_e_cal_backend_sync_create_object): ditto, and notify listeners with
	the modified calobj.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object):
	* backends/file/e-cal-backend-file.c (e_cal_backend_file_create_object):
	adapted to changes in ECalBackendSync, and return the modified object
	to the caller.

2004-03-22  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.[ch]
	(e_gw_connection_send_appointment): added a 'id' argument, to be
	passed to e_gw_connection_send_item.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object,
	e_cal_backend_groupwise_modify_object, send_object): added extra
	argument to e_gw_connection_send_appointment.

2004-03-19  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.[ch]
	(e_cal_backend_groupwise_notify_error_code): new function.
	(populate_cache, get_deltas, connect_to_server,
	e_cal_backend_groupwise_open): notify clients of any error.

2004-03-19  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(start_freebusy_session): don't use the "types:" prefix for the
	<user> SOAP element.

2004-03-19  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove_object): remove the object from the
	cache in the remote case also.

2004-03-19  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove_object): if we don't find the
	X-EVOLUTION-GROUPWISE-ID property, the object didn't come from
	the server, so don't try to remove it.

2004-03-19  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]
	(e_cal_backend_cache_get_timezone, e_cal_backend_cache_put_timezone,
	e_cal_backend_cache_remove_timezone): new functions to support
	timezones in the cache.
	(e_cal_backend_cache_get_components): only append to the returned
	list the VEVENT's and VTODO's components.
	(e_cal_backend_cache_init): create a hash table to store all the
	icaltimezone objects we create in e_cal_backend_cache_get_timezone.
	(e_cal_backend_cache_finalize): free the timezones hash table.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove_object): remove object based on the
	Groupwise item ID, not the iCalendar ID.

2004-03-18  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(e_gw_connection_get_freebusy_info): send back "freeBusySessionId"
	rather than "session"

2004-03-18  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(start_freebusy_session): put the xml prefixes back in, they
	weren't the issue

2004-03-18  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(set_properties_from_cal_component): set the GW item ID based on the
	X-EVOLUTION-GROUPWISE-ID property.
	(e_gw_item_to_cal_component): add the above property to the created
	ECalComponent, and use our iCalendar ID to set the "iCalId" property.

2004-03-18  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(start_freebusy_session): remove xml prefixes

2004-03-18  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(start_freebusy_session): list the the addresses in the <email>
	attribute

2004-03-18  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c: add e_return_error macro to fail more
	gracefully as per ebook

2004-03-18  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object,
	e_cal_backend_groupwise_modify_object): don't update the cache when we
	get an error from the server.

2004-03-17  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #55719

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_get_cal_address): deal with online/offline
	modes.
	(e_cal_backend_groupwise_finalize): free new private field.

2004-03-16 Harish K <kharish@novell.com>

	* libecal/e-cal.c : Move open_calendar call into async_idle_cb
	and rearrange mutex lock/unlock sequences. This fixes the calendar 
	authentication problems observed while using the Password Dialog.

2004-03-15  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c (func_occur_in_time_range): expand
	recurrences for the given time range to be sure that we return the
	correct events.
	(check_instance_time_range_cb): callback to check the expanded recurrences.

2004-03-15  Rodney Dawes  <dobey@ximian.com>

	* libecal/libecal-1.0.pc.in:
	* libedata-cal/libedata-cal-1.0.pc.in: Add @LIBBONOBO_REQUIRED@ for
	the libbonobo dependency

2004-03-14  Harish K <kharish@novell.com>

	* calendar/backends/groupwise/e-cal-backend-groupwise.c :
	Update calls to e_gw_connection_get_items with the new prototype.

2004-03-11  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-data-cal.c (e_data_cal_notify_objects_sent): guard
	against sending NULL strings to CORBA.

	* backends/contacts/e-cal-backend-contacts.c
	(e_cal_backend_contacts_receive_objects,
	e_cal_backend_contacts_send_objects): return PermissionDenied error.

2004-03-09  JP Rosevear <jpr@ximian.com>

	Fixes #55389
	
	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_send_objects): return the calendar object
	properly

2004-03-09  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (e_cal_resolve_tzid): don't default to UTC timezone,
	the default timezone is used by the timezone look up code.

2004-03-09  Thomas Mirlacher <dent@cosy.sbg.ac.at>

	Fixes #53885

	* backends/contacts/e-cal-backend-contacts.c:
	intermediate fix for recurring entries starting before 1970
	set the dtend for making valid whole-day entries

2004-03-05  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #54280

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_send_objects): added missing implementation.

2004-03-05 Harish K <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c :
	timezone values in ECalDateComponent structures should be
	set to "UTC" for GW items.
	
2004-03-01  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #33243

	* libedata-cal/e-cal-backend-sexp.c (matches_location): new function
	to check if a component's location matches a string.
	(matches_any): call matches_location also.
	(func_contains): added support for searching the location also.

2004-03-01  Rodrigo Moya <rodrigo@ximian.com>

	* idl/Evolution-DataServer-Calendar.idl: added new arguments to the
	notifyObjectsSent method for backends to return the list of users and
	events for which it operated.

	* libedata-cal/e-data-cal.[ch] (e_data_cal_notify_objects_sent): added
	new argument and call the listener's notifyObjectsSent method with
	a GNOME_Evolution_Calendar_UserList.

	* libedata-cal/e-cal-backend-sync.[ch] (e_cal_backend_sync_send_objects,
	_e_cal_backend_send_objects): added new arguments.

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_send_objects):
	* backends/http/e-cal-backend-http.c (e_cal_backend_http_send_objects):
	* backends/contacts/e-cal-backend-contacts.c
	(e_cal_backend_contacts_send_objects):
	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_send_objects): adapted to changes in
	ECalBackend/ECalBackendSync API.

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_receive_objects,
	e_cal_backend_file_send_objects): removed wrong return statement.

	* libecal/e-cal-marshal.list: added new marshaller.

	* libecal/e-cal.[ch] (e_cal_send_objects): get the user list from the
	operation's result.
	(cal_objects_sent_cb): added the new arguments and copy them to the
	operation's result.

	* libecal/e-cal-listener.[ch]: added new arguments to "send_objects"
	signal.
	(impl_notifyObjectsSent): added UserList argument to CORBA method, and
	convert the CORBA user list to a GList to be passed to the signal
	handlers.
	(e_cal_listener_class_init): added new arguments to "send_objects"
	signal.

2004-02-26  JP Rosevear <jpr@ximian.com>

	* tests/ecal/test-ecal.c: make EXPECTED a macro so it compiles

2004-02-26 Harish K <kharish@novell.com>

	* tests/ecal/test-ecal.c : Added implementation of 
	test cases.
	* (tests/ecal/test-runner.sh, tests/ecal/cleanup.sh
	   tests/ecal/testdata.ics) : Added test scripts and test data.
	* tests/ecal/Makefile.am : Add scripts to EXTRA_DIST.

2004-02-23  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/Makefile.am: Add includes for srcdir !=
	builddir

	* backends/file/Makefile.am: ditto

	* backends/contacts/Makefile.am: ditto

	* libedata-cal/Makefile.am: ditto

	* libecal/Makefile.am: ditto

	* tests/ecal/Makefile.am: ditto

2004-02-17 Harish K <kharish@novell.com>
	* libecal/e-cal.c : 
	(e_cal_new_system_calendar, e_cal_new_system_tasks) : arguments
	to g_build_filename should be NULL terminated.

2004-02-12  Chris Toshok  <toshok@ximian.com>

	* backends/contacts/e-cal-backend-contacts.c (book_record_new):
	quiet the compiler, and free the list of requested fields after
	the e_book_get_book_view call.
	(e_cal_backend_contacts_init): use e_book_get_addressbooks instead
	of using gconf and hardcoding the sourcelist xml key.

2004-02-10  Rodrigo Moya <rodrigo@ximian.com>

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_receive_objects):
	switch wrongly-placed creation/modification of objects.

2004-02-06  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.c
	(set_properties_from_cal_component, e_gw_item_to_cal_component):
	adapted to changes in EGwItem.

	* libecal/e-cal.c (e_cal_open_async): no need to make the thread joinable.

2004-02-06  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise-utils.[ch]: new files
	to contain all calendar-specific code from libegroupwise.
	(e_gw_item_new_from_cal_component, e_gw_item_to_cal_component,
	e_gw_connection_send_appointment): new functions.

	* backends/groupwise/e-cal-backend-groupwise.c: include new header
	file.

2004-02-06  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c:
	* backends/groupwise/soap-test.c:
	* backends/groupwise/e-gw-*: moved to $top_srcdir/servers/groupwise.

	* backends/groupwise/Makefile.am: removed files and don't build test
	programs.

2004-02-06  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (parse_response_status):
	"Status" is now "status".

2004-02-04  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: update proto

	* libecal/e-cal.c (async_idle_cb): return FALSE to remove the idle
	handler
	(get_default): take an auth func and use it 
	(e_cal_open_default): ditto

2004-02-04  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: redo protos

	* libecal/e-cal.c (e_cal_open_default): open the default ecal
	based on type
	(e_cal_set_default): set the default based on type
	(e_cal_set_default_source): ditto
	(e_cal_get_sources): get the source list based on type

2004-02-04  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (open_calendar): new function created from
	e_cal_open, without signal emissions.
	(e_cal_open): call open_calendar() and emit signals.
	(e_cal_open_async): changed to use a thread instead
	of an idle callback.
	(open_async): converted to a GThreadFunc, call open_calendar and
	setup idle callback to emit the "cal_opened" signal.
	(async_idle_cb): idle callback, notify listeners with the
	"cal_opened" signal and free ECalAsyncData.

	* backends/file/e-cal-backend-file.c: store an ordered list of all
	detached recurrences, as well as the hash table, for each object.
	(free_object): free the recurrences list, and the object's data.
	(add_component, remove_instance): add the recurrences to the
	recurrences list also.
	(e_cal_backend_file_modify_object): remove the recurrence from the
	list also, and it to the list when adding it to the hash table.
	(remove_object_instance_cb): remove the recurrences from the list
	also.
	(e_cal_backend_file_receive_objects): remove cancelled meetings from the
	received toplevel component before merging it. Add/Update received
	objects approppriately for PUBLISH/REQUEST/REPLY.

2004-02-04  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (open_async): g_object_unref the ECal, not the
	ECalAsyncData structure.

2004-02-03  Rodney Dawes  <dobey@ximian.com>

	* backends/http/e-cal-backend-http.c: Don't keep a global SoupMessage
	(e_cal_backend_http_fianlize): Abort the session, as we may have
	multiple messages running
	(webcal_to_http_method): Return a copy if we aren't parsing a webcal:,
	as there is no need to return NULL, since we just check and copy the
	original anyway
	(retrieval_done): Handle redirection, and don't rely on a global
	SoupMessage for things, and don't try to set the SoupMessage to NULL
	(begin_retrieval_cb): Allow multiple messages, and disable automatic
	redirect handling, as we need to handle it ourselves
	(maybe_start_reload_timeout): We want minutes, not seconds, so we need
	to multiply the refresh value by 60000 instead of 1000

2004-02-03  Dan Winship  <danw@ximian.com>

	* backends/http/e-cal-backend-http.c (e_cal_backend_http_finalize,
	retrieval_done): Don't unref the soup message; that happens
	automatically after the callback runs. #53645

2004-02-03  Harish K <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise.c : 
	added get_deltas function as the callback to update cache.
	* backends/groupwise/e-gw-connection.[ch] (parse_response_status):
	Removed UpdateCacheHandle structure as
	the callback is now local to e-cal-backend-groupwise.c
	(e_gw_connection_get_deltas) : modified  the function to return 
	list of EGwItems.
	(set_attendee_list_from_soap_parameter) : moved to EGwItem.
	* backends/groupwise/e-gw-item.c : Added attendee_list to priv
	structure and updated e_gw_item_dispose to free it.
	(e_gw_item_new_from_soap_parameter) : added code to parse 'changes'
	element in item.
	
2004-02-03  Chris Toshok  <toshok@ximian.com>

	* backends/groupwise/e-gw-connection.c (parse_response_status):
	E_GW_CONNECTION_BAD_PARAMETER ->
	E_GW_CONNECTION_STATUS_BAD_PARAMETER.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.[ch] (parse_response_status):
	added new error code.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c (populate_cache):
	add all retrieved items to the cache, since calendar and tasks
	both use the same cache file.
	(e_cal_backend_groupwise_get_object,
	e_cal_backend_groupwise_get_object_list): only return items of the
	same kind as the backend.
	(e_cal_backend_groupwise_create_object): only allow storing of
	items of the same kind as the backend.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.c (e_gw_item_append_to_soap_message):
	fixed argument ordering in call to e_gw_message_write_string_parameter.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c (populate_cache):
	changed to have an ECalBackendGroupwise as argument, and only add
	to the cache objects of the same kind as the backend.
	(connect_to_server): pass the ECalBackendGroupwise to populate_cache.

	* backends/groupwise/e-gw-item.c (e_gw_item_to_calcomponent):
	set altrep to NULL on ECalComponentText's.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.c (e_gw_item_to_calcomponent): moved
	calls to e_cal_component_set_new_vtype up, so that the internal
	icalcomponent gets created. Added missing 'break' statement.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(e_gw_connection_get_freebusy_info): fixed warning.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove_object): pass the container_id to
	e_gw_connection_remove_item.

2004-02-02  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c (connect_to_server):
	set the ESource's name to the name of the folder.

2004-02-01  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: order the signals more sensibly

	* libecal/e-cal.c (destroy_factories): use G_STRLOC
	(categories_changed_cb): set the size of the array so the length
	is set
	(e_cal_init): remove extra listener args, listen for new signals

	* libecal/e-cal-marshal.list: add signal marshaller

	* libecal/e-cal-listener.h: add new signals, remove function
	callback protos, update protos

	* libecal/e-cal-listener.c (impl_notifyErrorOccurred): emit error
	signal
	(impl_notifyCategoriesChanged): emit categories changed signal
	(e_cal_listener_init): remove dead initializations
	(e_cal_listener_finalize): remove dead finalizations
	(e_cal_listener_class_init): add category and error signals
	(e_cal_listener_construct): remove error and category function
	params
	(e_cal_listener_new): ditto

2004-01-31  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_is_read_only): return a proper GError and
	boolean

	* backends/contacts/e-cal-backend-contacts.c
	(e_cal_backend_contacts_get_type): remove debug statements
	
2004-01-30  Radek Doulik  <rodo@ximian.com>

	* backends/contacts/e-cal-backend-contacts.c (contact_record_new):
	make sure anniversary/birthday components were created before
	using them
	(contact_record_free): ditto
	(contact_record_cb): ditto

2004-01-30  Rodrigo Moya <rodrigo@ximian.com>

	* backends/http/Makefile.am: LOG_DOMAIN is ...http, not ...file.

	* backends/http/e-cal-backend-http.c (reaload_cb): don't start a new
	updload if we're already uploading.

2004-01-29  Hans Petter Jansson  <hpj@ximian.com>

	* backends/http/e-cal-backend-http.c (retrieval_done): Clear the
	is_loading flag.
	(begin_retrieval_cb): Set the is_loading flag, maybe start the reload
	timeout.
	(reload_cb): Implement.
	(maybe_start_reload_timeout): Implement.
	(e_cal_backend_http_open): Init reload timeout ID.

2004-01-29  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.c (e_gw_item_append_to_soap_message):
	write all properties to the message.

2004-01-29  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.[ch] (e_gw_item_new_from_soap_parameter,
	e_gw_item_to_cal_component, e_gw_item_get_id, e_gw_item_set_id,
	e_gw_item_get_creation_date, e_gw_item_set_creation_date,
	e_gw_item_get_start_date, e_gw_item_set_start_date,
	e_gw_item_get_classification, e_gw_item_set_classification,
	e_gw_item_get_accept_level, e_gw_item_set_accept_level,
	e_gw_item_get_subject, e_gw_item_set_subject,
	e_gw_item_get_priority, e_gw_item_set_priority,
	e_gw_item_get_message, e_gw_item_set_message,
	e_gw_item_get_completed, e_gw_item_set_completed,
	e_gw_item_get_due_date, e_gw_item_set_due_date,
	e_gw_item_get_end_date, e_gw_item_set_end_date,
	e_gw_item_get_place, e_gw_item_set_place): new functions.
	(e_gw_item_new_from_cal_component): renamed. Don't keep the
	ECalComponent, there's no need for it.
	(append_appointment_properties): don't use the private ECalComponent,
	it's not stored anymore.
	(e_gw_item_dispose): free all properties.
	(e_gw_item_append_to_soap_message): added support for tasks.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_get_items):
	(e_gw_connection_send_appointment): use
	e_gw_item_new_from_cal_component.
	(get_e_cal_component_from_soap_parameter, get_evo_date_from_string):
	removed.
	(e_gw_item_get_deltas, update_cache_item): disabled until migrated to
	use EGwItem's.
	(e_gw_connection_get_date_from_string): new function.

	* backends/groupwise/e-gw-container.c (e_gw_container_finalize): fixed
	warnings.

2004-01-28  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.c: added missing header.

2004-01-28  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #53465

	* libecal/e-cal.c (e_cal_get_error_message): fixed typo.

2004-01-28  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.[ch]
	(e_gw_item_append_to_soap_message): new function.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_send_item):
	finished implementation.

2004-01-28 Harish K <kharish@novell.com>

	* calendar/backends/groupwise/e-cal-backend-groupwise.c :
	Pass the correct arguments to the callback function 
	* calendar/backends/groupwise/e-gw-connection.c :
	(e_gw_connection_get_container_id) : Initialize container_list.
	(e-gw-connection_get_deltas) : fixed the prototype to match
	the callback prototype
	(set_attendee_list_from_soap_param): modified 
	get_attendee_list_from_soap_param to update calendar component
	within the same function.
	(e-gw-connection_get_items) : check item types before creating
	e-cal-components.
	* calendar/backends/groupwise/e-gw-connection.h : added 
	CacheUpdateHandle structure. 

2004-01-28  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: add protos

	* libecal/e-cal.c (e_cal_new_system_calendar): return a pointer to
	the system calendar
	(e_cal_new_system_tasks): ditto for tasks
	(get_default): gets the default calendar/tasks
	(e_cal_get_default_calendar): gets the default calendar
	(e_cal_get_default_tasks): ditto for tasks
	(e_cal_set_default_calendar): sets the default calendar
	(e_cal_set_default_tasks): ditto for tasks
	(set_default_source): set the default calendar/tasks source
	(e_cal_set_default_calendar_source): set the default calendar
	source
	(e_cal_set_default_tasks_source): ditto for tasks
	(get_sources): get a source list given a gconf key
	(e_cal_get_calendars): get the calendar source list
	(e_cal_get_tasks): get the tasks source list

2004-01-28  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-container.[ch]: new class to contain all
	information about containers in the server.

	* backends/groupwise/e-gw-connection.[ch]
	(e_ge_connection_free_container_list): new function.
	(e_gw_connection_get_container_list): changed to return a list of
	EGwContainer's.
	(e_gw_connection_get_container_id): adapted to changes made in
	e_gw_connection_get_container_list().

2004-01-27  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: update proto

	* libecal/e-cal.c (e_cal_remove): rename from
	e_cal_remove_calendar
	(e_cal_get_error_message): key on new status name

	* libecal/e-cal-types.h: rename
	E_CALENDAR_STATUS_CARD_ID_ALREADY_EXISTS to
	E_CALENDAR_STATUS_OBJECT_ID_ALREADY_EXISTS, delete duplicate enum

	* idl/Evolution-DataServer-Calendar.idl: rename
	CardIdAlreadyExists to ObjectIdAlreadyExists

	* libecal/e-cal-listener.c (convert_status): key on new name
	
	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_create_object): return object id already
	exists

2004-01-27  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(get_e_cal_component_from_soap_parameter): not having the priority
	or dueDate properties is not an error.

2004-01-27  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(get_attendee_list_from_soap_parameter): don't allocate memory for
	ECalComponentAttendee's fields, make them just point to the values
	contained in the SoupSoapResponse.
	(get_e_cal_component_from_soap_parameter): don't free
	ECalComponentAttendee's fields, free the structure.
	(e_gw_connection_send_item): fixed warnings.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_get_object):
	(e_cal_backend_groupwise_remove): lock/unlock the mutex when accessing
	private fields.

2004-01-27  JP Rosevear <jpr@ximian.com>

	* libedata-cal/e-cal-backend-cache.c (get_filename_from_uri): take
	a const uri
	(e_cal_backend_cache_set_property): pass a const value
	(e_cal_backend_cache_constructor): uri is const
	(e_cal_backend_cache_put_component): rid is const
	(e_cal_backend_cache_get_components): distinguish between GList
	and GSList

	* libedata-cal/e-cal-backend-sexp.c (func_uid): make sure we
	always set a return value

2004-01-27  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(get_e_cal_component_from_soap_parameter): description is not
	const

2004-01-27  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_start_query): fixed memory leaks and use
	g_list_* functions for GList's, not g_slist_*.
	(match_object_sexp, match_recurrence_sexp): removed unneeded functions,
	we match the object directly in get_object_list.
	(e_cal_backend_groupwise_start_query): call get_object_list to retrieve
	the matched objects and call e_data_cal_view_notify_* functions
	appropriately.

2004-01-26  Harish K <kharish@novell.com>

	* calendar/backends/groupwise/e-cal-backend-groupwise.c :
	(e_cal_backend_groupwise_internal_get_default_timezone,
	e_cal_backend_groupwise_internal_get_timezone) : added and 
	implemented.
	(e_cal_backend_groupwise_get_object_list) : fixed incorrect
	access to the list.
	(e_cal_backend_groupwise_start_query) : fixed compiler warnings.
	 
	* calendar/backends/groupwise/e-gw-connection.c :
	(e_gw_connection_get_container_id) : Modified elements 'Folders' to 
	the 'folders' due to change in the server implementation.
	Fixed compiler warnings.

2004-01-24  Rodrigo Moya <rodrigo@ximian.com>

	* backends/http/e-cal-backend-http.c: make it use
	ECalBackendCache for its cache, and libsoup for the HTTP
	retrieval.
	(retrieval_progress_cb, uri_to_cache_dir, ensure_cache_dir): removed
	unneeded functions.
	(e_cal_backend_http_finalize): cancel Soup message here, if any, and
	close Soup session.
	(begin_retrieval_cb): use soup_session_queue_message() to send the
	HTTP request to the server.
	(retrieval_done): update the cache on success, and changed to be the
	callback for the Soup async message.
	(e_cal_backend_http_open): create a ECalBackendCache, not an
	ECalBackendFile.
	(e_cal_backend_http_remove): remove the cache.
	(e_cal_backend_http_is_loaded, e_cal_backend_http_get_default_object,
	e_cal_backend_http_get_object, e_cal_backend_http_get_timezone,
	e_cal_backend_http_add_timezone,
	e_cal_backend_http_set_default_timezone,
	e_cal_backend_http_get_object_list, e_cal_backend_http_start_query,
	e_cal_backend_http_get_default_timezone,
	e_cal_backend_http_get_timezone):
	dont proxy calls to the file backend, use the cache instead.
	(e_cal_backend_http_create_object, e_cal_backend_http_modify_object,
	e_cal_backend_http_remove_object, e_cal_backend_http_receive_objects,
	e_cal_backend_http_send_objects):
	the HTTP backend is read only, return permission denied error.

	* backends/http/Makefile.am: added SOUP_CFLAGS|LIBS.

	* backends/groupwise/Makefile.am: s/GROUPWISE/SOUP.

2004-01-23  Harish K <kharish@novell.com>

	* calendar/backends/groupwise/e-cal-backend-groupwise.c
	  Removed update_cache function and refactored the call-back 
	  to use e-gw-connection_get_deltas instead of update_cache.
	* calendar/backends/groupwise/e-gw-connection.c
	  use g_new0 instead of g_malloc0 and added NULL check for 
	  validating the soap responses. 
	  (get_e_cal_component_from_soap_parameter) added code to
	  parse 'message' into description.
	  
2004-01-22 Harish K <kharish@novell.com>

	* calendar/backends/groupwise/e-cal-backend-groupwise.c
	  (populate_cache, e_cal_backend_groupwise_get_object_list,
	  e_cal_backend_groupwise_get_free_busy ) :changed implementation
	  to use GList instead of GSList, aligning to the rest of the
	  backends.
	  (e_cal_backend_groupwise_get_changes, update_cache): implemented.

	* calendar/backends/groupwise/e-gw-connection.c
	  (get_attendee_list_from_soap_parameter) : modified 
          get_attendee_list_from_string to handle recipients element.
	  (get_e_cal_component_from_soap_parameter) -fixed memory leaks.
	  (update_cache_item) : implemented.
	  (e_gw_connection_get_freebusy_info, start_freebusy_session)
	  GSList to GList changes.

	* calendar/backends/groupwise/e-gw-connection.h : updated 
          declarations for the above changes.

	* calendar/libedata-cal/e-cal-backend-cache.[ch] :
	  (e_cal_backend_cache_get_components) : return GList instead of
          GSList.
          
2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove): remove the cache from disk
	when removing the calendar.

	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_remove): added missing call to g_dir_close().

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_remove):
	use the full path when removing files.

2004-01-21  JP Rosevear <jpr@ximian.com>

	* libecal/Makefile.am: don't build client test

2004-01-21  JP Rosevear <jpr@ximian.com>

	* tests/ecal/test-ecal.c: the beginnings of a test client

	* tests/ecal/Makefile.am: build the test client

	* tests/Makefile.am: add ecal subdir

	* Makefile.am: add tests subdir

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (e_cal_new): create the component listener
	here, so that backend_died_cb gets called when the backend dies.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(connect_to_server): added code for retrieving the container ID
	for tasks also.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): added missing g_mutex_unlock
	call.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(get_e_cal_component_from_soap_parameter): check arguments before
	passing them to functions to avoid warnings at runtime.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/file/e-cal-backend-file.c (create_cal): create
	directory tree to contain the calendar.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(get_e_cal_component_from_soap_parameter): return error when
	the type of the component does not match the supported ones.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #51705

	* backends/file/e-cal-backend-file.c (e_cal_backend_file_remove):
	remove all files in the directory and the directory itself.

2004-01-21  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c (match_recurrence_sexp,
	match_object_sexp): use a GSList, which is what we are passed
	to e_cal_backend_groupwise_get_object_list.
	(e_cal_backend_groupwise_start_query): fixed warning.

2004-01-20  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_set_mode): split out the connection code.
	(connect_to_server): and moved it here.
	(e_cal_backend_groupwise_open): call connect_to_server, not
	set_mode, to avoid online/offline notifications.

2004-01-19  Harish K <kharish@novell.com> 

	* backends/groupwise/e-gw-connection.c :
	(get_e_cal_component_from_soap_parameter):
	'due' property set for TODOs instead of dtend.
	added code for mapping all values of GW data to
	percent, priority, classification, transparency
	properties in ECalComponent.
	Fixed compiler warnings.

2004-01-18  Harish K <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise.c :
	(e_cal_backend_groupwise_get_free_busy): Implemented.
	* backends/groupwise/e-gw-connection.[ch] :
	(e_gw_connection_get_deltas) : Implemented parsing of
	the response.
	(e_gw_connection_get_free_busy_info) : Implemented
	including private functions  
	(get_attendee_list_from_string, start_freebusy_session and
	close_freebusy_session).
	(e_gw_connection_get_container_id) : remove unused variable.
	(get_e_cal_component_from_soap_parameter) : added code to 
	set attendee_list to the e_cal_component.
	(get_evo_date_from_string) : fixed typo.

2004-01-16  JP Rosevear <jpr@ximian.com>

	* backends/file/e-cal-backend-file.c (save): remove test bits

2004-01-16  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c (categories_changed_idle_cb): remove debug
	statement

2004-01-16  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (e_cal_open): return AUTH_REQUIRED error if
	we don't get a password from the authentication function.

	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_modify_object): store the old object before
	actually losing it.

2004-01-16  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c: name space the idle data structs properly

2004-01-16  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c (backend_error_idle_cb): idle handler to
	actually proxy the signal emission to the main thread
	(backend_error_cb): use above
	(categories_changed_idle_cb): idle handler for proxying
	(categories_changed_cb): use above

	Fixes #52743
	
2004-01-16  Christian Neumair  <chris@gnome-de.org>

	* libedata-cal/e-cal-backend-sexp.c (func_uid):
	Error message string fix.

2004-01-16  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.c (get_filename_from_uri): use
	~/.evolution/cache/calendar for the cache files.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_get_object_list): lock/unlock the
	private mutex.

2004-01-16  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(e_gw_connection_get_container_id): fixed duplicated variable name.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): removed check for 'only_if_exists',
	we'll return NoSuchCal error if we can't find the calendar to open.

2004-01-15  Mark McLoughlin  <mark@skynet.ie>

	* libecal/e-cal-listener.c: (impl_notifyCalSetMode),
	(impl_notifyErrorOccurred), (impl_notifyCategoriesChanged):
	Remove debugging spew.

2004-01-15  Radek Doulik  <rodo@ximian.com>

	* libecal/e-cal.c (e_cal_is_read_only): fix the return value, it
	was returning ECalendarStatus instead of bool, it compares status
	to E_CALENDAR_STATUS_OK now

2004-01-14  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): if trying to create a new calendar,
	return an error, since we don't support that.
	(e_cal_backend_groupwise_remove): return "Permission Denied".

2004-01-14  Harish K <kharish@novell.com>

	* libedata-cal/e-cal-backend-cache.c
	(e_cal_backend_cache_get_components): return a list of e-cal-components
        rather than e-cal-component strings.

2004-01-13  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-gw-connection.c
	(get_e_cal_component_from_soap_parameter): remove C99 declaration

2004-01-13  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-item.[ch] (e_gw_item_new_appointment):
	added a 'container' argument.
	(e_gw_item_dispose): free new field in the private structure.

	* backends/groupwise/e-gw-connection.[ch]
	(e_gw_connection_send_appointment): added a 'container' argument.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object,
	e_cal_backend_groupwise_modify_object): adapted to changes in
	e_gw_connection_send_appointment.
	(e_cal_backend_groupwise_receive_objects): implemented.

2004-01-13  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.[ch]
	(e_gw_connection_get_items): moved the folder retrieving code to...
	(e_gw_connection_get_container_id): ...here, new function.

	* backends/groupwise/e-cal-backend-groupwise.c: added 'container_id'
	field to private structure.
	(e_cal_backend_groupwise_finalize): free the container_id.
	(populate_cache): pass the container_id to e_gw_connection_get_items.
	(e_cal_backend_groupwise_set_mode): retrieve the container ID after
	connecting to the server.

2004-01-13  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.[ch] (logout): unref the message
	if we dont get a response, not the response, which is NULL, and unref
	it also before exiting the function.
	(e_gw_connection_remove_item): new function.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_remove_object): implemented.

2004-01-13  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal-component.[ch] (e_cal_component_get_recurid_as_string):
	new function, moved from the file and groupwise backends.

	* libedata-cal/e-cal-backend-cache.[ch]
	(e_cal_backend_cache_put_component): changed to get an ECalComponent.

	* backends/groupwise/e-gw-item.[ch]: new class for managing items
	to be sent to the server.

	* backends/groupwise/e-gw-connection.[ch] (e_gw_connection_send_item,
	e_gw_connection_send_appointment): new functions.
	(e_gw_connection_get_container_list): made it public.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_create_object): finished implementation.
	(e_cal_backend_groupwise_modify_object): implemented.
	(get_rid_string): removed.
	(populate_cache): adapted to changes in ECalBackendCache, and use
	e_cal_component_get_recurid_as_string instead of the local
	get_rid_string().

	* backends/groupwise/Makefile.am: added new files.

	* backends/file/e-cal-backend-file.c (get_rid_string): removed.
	(add_component, e_cal_backend_file_modify_object): use
	e_cal_component_get_recurid_as_string instead of the local
	get_rid_string().

2004-01-13 Harish K <kharish@novell.com>

	* calendar/backends/groupwise/e-cal-backend-groupwise.c
          (populate_cache): fixed memory leaks.
          (e_cal_backend_groupwise_open): return function with success when
          invoked again after the cache has been created already.
          (e_cal_backend_groupwise_get_object_list): implemented.
          (e_cal_backend_groupwise_start_query): implemented.

	* calendar/backends/groupwise/e-gw-connection.c
          (get_e_cal_component_from_soap_parameter): modification to strip
          date and time separators in argument before calling
          icaltime_from_string.

	* calendar/backends/groupwise/e-gw-connection.h
          (e_gw_connection_get_delta): - Added declaration.

	* calendar/libedata-cal/e-cal-backend-cache.c
          (e_cal_backend_cache_constructor): Added the function and updated
          class_init to use it.
          (e_cal_backend_cache_get_components): Added method to wrap 
          e_file_cache_get_objects for better abstraction.
          (e_cal_backend_cache_set_property): fixed NULL termination to argument
          list.

2004-01-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open):
	* backends/http/e-cal-backend-http.c (e_cal_backend_http_open): made
	the backends start online always, until we fix the online/offline
	handling via the shell.

2004-01-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.[ch]
	(e_gw_connection_get_user_name, e_gw_connection_get_user_uuid): new
	functions.

2004-01-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/http/e-cal-backend-http.c (uri_to_cache_dir): fixed leak.

2004-01-10  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c (func_occur_in_time_range):
	don't leak the dates retrieved with e_cal_component_get_dtstart/dtend.

	* libedata-cal/e-cal-backend-sync.c (_e_cal_backend_get_timezone):
	free the 'object' string returned by the provider's get_timezone
	method.

	* libedata-cal/e-data-cal-factory.c
	(e_data_cal_factory_register_method):
	g_free the string returned by g_ascii_strdown().

2004-01-10  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_get_timezone): fixed copy/paste typo.
	(e_cal_backend_groupwise_remove, e_cal_backend_groupwise_add_timezone,
	e_cal_backend_groupwise_set_default_timezone,
	e_cal_backend_groupwise_get_object_list,
	e_cal_backend_groupwise_get_free_busy,
	e_cal_backend_groupwise_get_changes,
	e_cal_backend_groupwise_discard_alarm,
	e_cal_backend_groupwise_modify_object,
	e_cal_backend_groupwise_remove_object,
	e_cal_backend_groupwise_receive_objects,
	e_cal_backend_groupwise_send_objects):
	fixed compilation warnings.

	* backends/groupwise/Makefile.am:
	* backends/groupwise/groupwise-config-listener.c: removed unused file.

2004-01-09  Harish K <kharish@novell.com>

	* backends/groupwise/e-cal-backend-groupwise.c
        (populate_cache): implemented.

	* backends/groupwise/e-gw-connection.h:
        added declaration for e_gw_connection_get_items.

	* backends/groupwise/e-gw-connection.c:
        (e-gw-connection-get-items) :implementation to obtain 
        calendar data from GW using SOAP.

2004-01-08  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c (convert_type): kill warning
	(e_cal_get_timezone): fix preconditions, tzid being NULL is valid,
	set *zone to NULL if we short circuit on a local time

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): keep the username and password
	passed from the client, and don't open the connection here.
	(e_cal_backend_groupwise_set_mode): ...do it here, when we change
	mode to 'online'.
	(e_cal_backend_groupwise_get_mode): implemented.
	(e_cal_backend_groupwise_is_loaded): check the cache, not the
	connection, since we can be loaded without being online.
	(populate_cache): made it static.

	* backends/http/e-cal-backend-http.c (begin_retrieval_cb): only
	begin the retrieval if we are online.

	* libecal/e-cal-util.h: added cal_mode_to_corba macro from
	e-cal-backend-http.c.

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (convert_type): removed g_assert_not_reached.

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (e_cal_get_alarms_for_object): pass the correct
	callback data for e_cal_resolve_tzid_cb().

2004-01-07  JP Rosevear <jpr@ximian.com>

	* libedata-cal/Makefile.am: remove DISABLE_DEPRECATED flags

	* libecal/Makefile.am: ditto

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (build_component_alarms_list): clone the icalcomponent
	to avoid having a pointer to an object that is freed afterwards, in
	e_cal_get_alarms_in_range.
	(e_cal_get_alarms_in_range): use icalcomponent_free to free the objects
	in the list returned by e_cal_get_object_list.

2004-01-07  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (build_component_alarms_list): pass the correct
	data (an ECal, not an icalcomponent) to e_cal_resolve_tzid_cb.

2004-01-06  JP Rosevear <jpr@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c (func_uid): implement uid
	checking for sexps
	(e_cal_backend_sexp_new): use nice glib macro to count sexp
	elements

	* libedata-cal/e-cal-backend-cache.c: guard config.h include and
	include string.h to kill warning

2004-01-06  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.c (build_component_alarms_list): the list returned
	by e_cal_get_object_list() contains icalcomponent's already,
	so no need to parse them as strings.
	(e_cal_open): fixed warning.

2004-01-05  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.[ch]
	(e_gw_message_write_string_parameter): added 'prefix' argument, for
	not hard-coding all parameters to the "types" prefix.

	* backends/groupwise/e-gw-connection.c (logout, e_gw_connection_new,
	e_gw_connection_get_items): pass the XML prefix to
	e_gw_message_write_string_parameter().

2004-01-05  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch] (e_cal_backend_cache_put_object):
	merged _add_component and _replace_component into a single function.

	* backends/groupwise/e-cal-backend-groupwise.c (populate_cache):
	use e_cal_backend_cache_put_object, and let the cache deal with
	additions/replacements.

2004-01-05  Sivaiah Nallagatla <snallagatla@novell.com>

	* backends/groupwise/groupwise-config-listener.[ch] : new class implementing addition,
	removal, modification of e-sources for calender and tasks for groupwise accounts.
	
	* backends/groupwise/Makefile.am : added above two files in  Makefile.am 

2004-01-05  Christian Neumair  <chris@gnome-de.org>

	* libedata-cal/e-cal-backend-sexp.c: Generalize some strings.

2003-12-24  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (e_gw_connection_get_items):
	fixed warning.

2003-12-24  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.[ch] (e_gw_message_new_with_header):
	added 'session_id' argument, to add the <Header> SOAP part if not NULL.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_get_items): use
	e_gw_message_new_with_header to create the SOAP message. Also, unref
	the correct object if we don't get a response from
	e_gw_connection_send_message, or we when we can't find a parameter in
	the response.
	(logout): pass session ID to e_gw_message_new_with_header().
	(e_gw_connection_new): ditto.

	* backends/groupwise/e-cal-backend-groupwise.c: removed 'icalcomp'
	field from the ECalBackendGroupwisePrivate structure.
	(e_cal_backend_groupwise_get_timezone): don't use priv->icalcomp
	to retrieve timezones, since that object is empty, use the libical's
	built-in timezones.
	(populate_cache): fixed C99'isms and re-enabled g_mutex_lock/_unlock
	calls.

2003-12-24  Harish Krishnaswamy <kharish@novell.com>

	* backends/groupwise/e-gw-connection.[ch] (e_gw_connection_get_items):
	new function.

	* backends/groupwise/e-cal-backend-groupwise.c (populate_cache): new
	function to populate the cache with all objects from the server.
	(e_cal_backend_groupwise_open): call populate_cache when opening the
	connection, to get all objects from the server.
	(e_cal_backend_groupwise_get_default_object): implemented.
	(e_cal_backend_groupwise_get_timezone): implemented.

2003-12-22  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c (func_has_alarms): removed useless
	'has_to_have_alarms' variable.

2003-12-22  JP Rosevear <jpr@ximian.com>

	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_modify_object): check the kind with the parent
	(e_cal_backend_file_create_object): ditto

2003-12-21  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: update protos

	* libecal/e-cal.c: use ECalSourceType
	(convert_type): convert and ECalSourceType to a corba equivalent
	(fetch_corba_cal): use ECalSourceType
	(e_cal_new): ditto
	(e_cal_new_from_uri): ditto
	(e_cal_generate_instances): does not need a type arg

	* libecal/e-cal-util.h: remove CalObjType

	* libecal/client-test.c (create_client): use ECalSourceType
	(main): ditto

2003-12-21  JP Rosevear <jpr@ximian.com>

	* backends/file/e-cal-backend-file.c (open_cal): set the uri
	before scanning the vcalendar because we may have to fix duplicate
	UIDs (and hence save the calendar)

2003-12-19 JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_get_alarms_in_range): create a valid sexp

2003-12-19  Rodrigo Moya <rodrigo@ximian.com>

	* libecal/e-cal.[ch] (e_cal_class_init):  removed 'forget_password'
	signal, since it's not used anywhere.

2003-12-19  Rodrigo Moya <rodrigo@ximian.com>

	* idl/Evolution-DataServer-Calendar.idl: added 'username' and 'password'
	arguments to Cal::open method, so that we can send authentication
	from the clients.

	* libedata-cal/e-cal-backend.[ch] (e_cal_backend_open):
	* libedata-cal/e-cal-backend-sync.[ch] (e_cal_backend_sync_open,
	_e_cal_backend_open):
	* libedata-cal/e-data-cal.c (impl_Cal_open):
	* backends/http/e-cal-backend-http.c (e_cal_backend_http_open):
	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open):
	* backends/file/e-cal-backend-file.c (e_cal_backend_file_open): adapted
	to changes in above method.

	* libecal/e-cal.[ch]: added E_CAL_LOAD_AUTHENTICATING to LoadState enum.
	(e_cal_open): check with the ESource if the server needs authentication
	or not, and if so, ask the client's provided auth function. Call
	GNOME_Evolution_Calendar_Cal_Open with the new arguments.

2003-12-18  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c: use a GMutex for
	thread safety.
	(e_cal_backend_groupwise_init): create the GMutex.
	(e_cal_backend_groupwise_finalize): free the GMutex.
	(e_cal_backend_groupwise_open): use the mutex.

2003-12-17  JP Rosevear <jpr@ximian.com>

	* backends/groupwise/e-gw-connection.c (e_gw_connection_init):
	create a synchronous session

2003-12-17  Hans Petter Jansson  <hpj@ximian.com>

	* libecal/e-cal.c (e_cal_finalize): Unref source.
	(fetch_corba_cal): Ref and keep source.
	(e_cal_get_source): Implement.

2003-12-17  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: added support for specifying
	a password, since we need one to connect to the server.

2003-12-16  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (e_gw_connection_new): no need to
	set the namespace for "types:", it's already set in
	e_gw_message_new_with_header().

2003-12-16  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.c (e_gw_message_new_with_header):
	added the namespace for the SOAP types.

	* backends/groupwise/e-gw-connection.c (logout): fixed copy-paste typo.

	* backends/groupwise/soap-test.c (idle_cb): unref the EGwConnection
	object, so that the logout message is sent to the server.

2003-12-16  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): return an AuthenticationFailed error
	when we can't open the connection.

2003-12-16  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_get_free_busy): the info is already in
	ECalComponent form, no need to process it again, from Gary Ekker
	<gekker@novell.com>

	Fixes #52218
	
2003-12-16  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (parse_response_status): map
	some error codes.
	(e_gw_connection_new): retrieve all the info returned in the UserInfo
	type (name, email and uuid).
	(e_gw_connection_disposee): free new private fields.

2003-12-16 Sivaiah Nallagatla <snallagatla@novell.com>
	
	* backends/groupwise/e-gw-connection.h
	* backends/groupwise/e-gw-connection.c (e_gw_connection_new,
	e_gw_connection_get_user_email)
	* backends/groupwise/e-cal-backend-groupwise.c (e_cal_backend_groupwise_get_ldap_attribute,
	e_cal_backend_groupwise_get_cal_address, e_cal_backend_groupwise_is_read_only,
	e_cal_backend_groupwise_get_alarm_email_address, e_cal_backend_groupwise_get_static_capabilities
	e_cal_backend_groupwise_open ): added implementation for all the apis listed above

2003-12-15  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal-listener.c (e_cal_listener_class_init): fix the
	number of parameters for get free busy and get_changes

2003-12-15  Rodrigo Moya <rodrigo@ximian.com>

	* backends/e-cal-backend-sync.c (_e_cal_backend_sync_get_ldap_attribute,
	_e_cal_backend_sync_get_static_capabilities,
	_e_cal_backend_sync_get_alarm_email_address): call the correct
	e_cal_backend_sync_* functions, typo pointed out by Siva.

2003-12-15  Rodrigo Moya <rodrigo@ximian.com>

	* backends/file/e-cal-backend-file.c
	(e_cal_backend_file_get_static_capabilities): g_strdup the
	'capabilities' argument, since it is expected to be freed in
	e-cal-backend-sync.c.

	* backends/http/e-cal-backend-http.c
	(e_cal_backend_http_get_static_capabilities): ditto.

2003-12-14  JP Rosevear <jpr@ximian.com>	

	* libecal/e-cal-component.c (set_datetime): don't remove and then
	free the param, lest we double free it

	Fixes #51633

2003-12-14  JP Rosevear <jpr@ximian.com>

	* libedata-cal/e-data-cal.c (e_data_cal_notify_free_busy): call
	the correct notification method

2003-12-13  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/Makefile.am: set the correct G_LOG_DOMAIN.

2003-12-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.c (e_gw_message_new_with_header):
	added SOAPAction header to the request.

2003-12-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.c (e_gw_message_write_footer): write
	the request's content here.
	(e_gw_message_new_with_header): add the Content-Type header.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_send_message):
	no need to write the request here, it's written in
	e_gw_message_write_footer().

2003-12-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.c (setup_debug): fixed typo.

	* backends/groupwise/Makefile.am: use $DEBUG_CFLAGS.

2003-12-12  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.c (setup_debug, print_header,
	debug_handler): new functions for adding debugging of the SOAP messages.
	(e_gw_message_new_with_header): if G_ENABLE_DEBUG is defined, setup
	debugging for the message. Also, use POST to send the messages.

	* doc/gw-soap-methods.xsd:
	* doc/gw-soap-types.xsd: added new versions of SOAP interfaces.

2003-12-11  Rodrigo Moya <rodrigo@ximian.com>

	Fixes #52013

	* backends/file/e-cal-backend-file.c (create_user_free_busy): pass
	the TIME arguments correctly.

2003-12-10  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c: use a SoupSession per
	EGwConnection, not one for all.
	(e_gw_connection_dispose): unref the SoupSession here.
	(e_gw_connection_init): create the SoupSession here.
	(e_gw_connection_send_message): use the private SoupSession.

2003-12-10  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/soap-test.c: added support for specifying a
	password in the command line.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_new): dont
	unref the response when we havent got one.

2003-12-10  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (e_gw_connection_finalize):
	only try to remove the connection from the hash table if the hash
	table has been created.

2003-12-10  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/soap-test.c: new test program to test the
	SOAP interface to the GW server.

	* backends/groupwise/Makefile.am: compile new test program.

2003-12-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_get_default_object): don't preload the
	timezones into the cache, its problematic because we don't want to
	have multiple operations at the same time and we don't do this for
	views for instance
	(e_cal_get_object): ditto

	Fixes #51225
	
2003-12-09  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal-listener.c (impl_notifyStaticCapabilities):
	actually emit the capabilities string

	Fixes #51747
	
2003-12-09  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.[ch]: made the connections be
	shared.
	(e_gw_connection_new): get the uri, username and password here, and
	before trying to login again to the server, see if we have already
	the same connection request in the loaded connections hash table.
	(e_gw_connection_login): removed.
	(e_gw_connection_logout): just unref the connection, the logout code
	moved to...
	(logout): ...here.
	(e_gw_connection_dispose): free new members.
	(e_gw_connection_finalize): remove the connection from the hash table,
	and destroy the hash table when there are no more connections on it.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_open): use the new EGwConnection interface.

2003-12-08  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.h: the class structure derives
	from EFileCacheClass, not EFileCache.

	* libedata-cal/e-cal-backend-cache.c (get_filename_from_uri): iterate
	correctly over the characters in the URI.

2003-12-08  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]: use EFileCache instead
	of ECache.

2003-12-08  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c (convert_uri):
	new function to convert "groupwise://" URIs to "http://".
	(e_cal_backend_groupwise_open): call the above function to
	get a GnomeVFSURI, and use it as a temporary hack to get
	username and password.

2003-12-07  JP Rosevear  <jpr@ximian.com>

	* libedata-cal/e-data-cal-factory.c: version the oafiid

	* libecal/e-cal.c (get_factories): update the repo id
	
2003-12-07  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c (get_factories): use the versioned repo id

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c (add_account): add the username
	in the source URI, and use e_source_list_sync, to give it time to
	sync the GConf changes.

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: changed to use a main loop,
	or saving to GConf seems not to work ??

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c (add_account): add the source
	to the group.

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: make it use a username also.

2003-12-04  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/create-account.c: added simple program to
	add accounts to the calendar sources until we a GUI to configure
	them.

	* backends/groupwise/Makefile.am: added noinst program.

2003-12-03  Christian Kellnerc <gicmo@xatom.net>

         * libedata-cal/e-cal-backend-sexp.c: added has-recurrences sexp
	 function

2003-12-03  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-cal-backend-groupwise.c: use a cache
	to keep the objects from the server.
	(e_cal_backend_groupwise_finalize): unref the cache object.
	(e_cal_backend_groupwise_open): load/create the local cache.
	(e_cal_backend_groupwise_get_object): look for the object in
	the cache.
	(e_cal_backend_groupwise_class_init): fixed warning.

2003-12-01  William Jon McCann  <mccann@jhu.edu>
 
        * libecal/e-cal.c (e_cal_generate_instances): Fix query and
        get object list as components.
 
2003-12-01  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]: changed to be based on the
	new ECache class.
	(get_filename_from_uri): new function to get a unique filename for a
	calendar/tasks URI.
	(e_cal_backend_cache_set_property): get the filename for the given URI
	and set the "filename" property on the cache, which will load/create
	the cache file.
	(e_cal_backend_cache_finalize): dont free removed fields.
	(e_cal_backend_cache_get_component, e_cal_backend_cache_add_component,
	e_cal_backend_cache_replace_component, e_cal_backend_cache_remove_component):
	new functions.

	* backends/groupwise/e-gw-connection.c (e_gw_connection_login): retrieve
	the session from the response, not the username.

2003-11-28  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.c (parse_response_status): new
	function to parse the "status" field returned in the SOAP response.
	(e_gw_connection_login, e_gw_connection_logout): call above function
	to get the status, and return that to the caller.
	
	* backends/groupwise/TODO: updated with more tasks.

2003-11-27  Rodrigo Moya <rodrigo@ximian.com>

	* libedata-cal/e-cal-backend-cache.[ch]: new class implementing a
	cache of calendar/tasks objects.

	* libedata-cal/Makefile.am: added new files.

2003-11-26  Hans Petter Jansson  <hpj@ximian.com>

	* idl/Evolution-DataServer-Calendar.idl (getCal): Take source XML
	instead of URI.

	* libecal/client-test.c (create_client): Adapt to API changes.
	(main): Ditto.

	* libecal/e-cal.c (fetch_corba_cal): Move to ESource.
	(e_cal_new): Take ESource.
	(e_cal_new_from_uri): Implement convenience call that takes URI.

	* libedata-cal/e-cal-backend.c (e_cal_backend_set_property):
	Implement PROP_SOURCE.
	(e_cal_backend_get_property): Same.
	(e_cal_backend_class_init): Same.
	(e_cal_backend_get_source): Same.

	* libedata-cal/e-data-cal-factory.c (impl_CalFactory_getCal): Take
	source XML and construct an ESource. Init backend with that.

2003-11-25  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-message.[ch]: new files to contain utility
	functions for easily creating SOAP messages.

	* backends/groupwise/e-gw-connection.[ch] (e_gw_connection_logout):
	new function.
	(e_gw_connection_finalize): if we're already connected, call
	e_gw_connection_logout().
	(e_gw_connection_login): implement response parsing.
	(e_gw_connection_send_message): new function.

	* backends/groupwise/e-cal-backend-groupwise.c
	(e_cal_backend_groupwise_is_loaded): implemented.

	* backends/groupwise/Makefile.am: added new files.

2003-11-20  Harry Lu  <harry.lu@sun.com>

	* backends/file/e-cal-backend-file.c:
	(e_cal_backend_file_internal_get_default_timezone): move to the front
	to avoid a compile warning.
	(e_cal_backend_file_internal_get_timezone): ditto.
	(sanitize_component): new function. If the component's timezone is not
	included in buildin timezone list, convert it to local default timezone.
	(e_cal_backend_file_create_object): call sanitize_component.
	(e_cal_backend_file_modify_object): ditto.
	(e_cal_backend_file_receive_objects): ditto.

2003-11-18  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/e-gw-connection.h: fixed typo.

	* backends/groupwise/e-gw-connection.c: base it on GObject, not
	SoupConnection.
	(e_gw_connection_login): new functions.
	(e_gw_connection_init): create the SoupSession here if it's not
	created, or ref it if it's already created.
	(e_gw_connection_finalize): unref the SoupSession here.
	(session_weak_ref_cb): callback to detect when the SoupSession dies.

	* backends/groupwise/e-cal-backend-groupwise.c: make it use
	EGwConnection's.
	(e_cal_backend_groupwise_finalize): unref the EGwConnection.
	(e_cal_backend_groupwise_open): create the EGwConnection here.

2003-11-17  Rodrigo Moya <rodrigo@ximian.com>

	* backends/groupwise/gw-connection.[ch]: new class for managing
	connections to Groupwise servers.

	* backends/groupwise/Makefile.am: added new files and needed
	CFLAGS and LIBS.

2003-11-17  Dan Winship  <danw@ximian.com>

	* libecal/e-cal-util.c (e_cal_util_new_component): New
	icalcomponent-based replacement for
	e_cal_component_new/e_cal_component_set_vtype.

	* libedata-cal/e-data-cal.c: fix up some broken indentation
	(e_data_cal_notify_default_object, e_data_cal_notify_object):
	constify the object arg

2003-11-14  Rodrigo Moya <rodrigo@ximian.com>

	* backends/Makefile.am: added groupwise backend directory to build.

	* backends/groupwise/Makefile.am:
	* backends/groupwise/e-cal-backend-groupwise.[ch]: Groupwise backend
	skeleton.

2003-11-11  ChangeLog <jpr@ximian.com>

	* libecal/e-cal.c (e_cal_class_init): emit the status

	* libecal/e-cal.h: remove open status enums, use calendar status
	instead

	* libecal/client-test.c (create_client): just directly open the
	calendar, no need to be async

2003-11-11  Dan Winship  <danw@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c: Make the time-related sexp
	function handlers (eg, time-now, make-time, etc) be non-static, so
	they can be reused by backend-specific calendar sexp parsers.

2003-11-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: remove dead enums

2003-11-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: mark struct as private

	* libecal/e-cal.c: fix documentation headers

	* libecal/e-cal-view.h: fix cast macros and typedef the structs
	separately

	* libecal/e-cal-view.c: use correct type check macro, fix some
	documentation headers

	* libecal/e-cal-view-listener.h: typedef the structs separately
	and tidy up class macros

	* libecal/e-cal-util.c: fix a documentation header

	* libecal/e-cal-listener.h: mark parts of the struct as private

	* libecal/e-cal-listener.c: fix a few documentation headers

	* libecal/e-cal-component.h: remove extraneous comma and mark
	parts of struct as private

	* libecal/e-cal-component.c: fix a couple of documentation headers

2003-11-10  Dan Winship  <danw@ximian.com>

	* libedata-cal/e-cal-backend-sexp.c: Remove get-vtype from the
	query language, since it is redundant now.
	(func_has_alarms): Remove the boolean arg from has-alarms. You can
	just say (not (has-alarms?)).

2003-11-10  JP Rosevear <jpr@ximian.com>

	* libecal/e-cal.h: add proto

	* libecal/e-cal.c (e_cal_free_change_list): this belongs here

	* libecal/e-cal-types.h: remove proto

	* libecal/Makefile.am: don't build dead file

2003-11-07  Dan Winship  <danw@ximian.com>

	* libecal/Makefile.am (libecal_la_LDFLAGS): Remove -no-undefined

	* libedata-cal/Makefile.am (libedata_cal_la_LDFLAGS): Likewise

2003-11-06    <jpr@ximian.com>

	* libecal/e-cal-view-listener.h: match the signals better

	* libecal/e-cal-view-listener.c (e_cal_view_listener_class_init):
	ditto
	
2003-11-06  JP Rosevear  <jpr@ximian.com>

	* libecal/e-cal.c: replace e_mutex stuff with gthread stuff

2003-11-06  JP Rosevear <jpr@ximian.com>

	* Makefile.am: build new subdirs

	* backends/*: build the http and file backends here

	* libedata-cal/Makefile.am: no longer build them here	
	
2003-11-05  JP Rosevear  <jpr@ximian.com>

	* rename libedatacal to libedata-cal

2003-11-05  JP Rosvear <jpr@ximian.com>

	* libecal/Makefile.am: use privincludedir

	* libedatacal/Makefile.am: ditto

	* libecal/libecal-1.0.pc.in: ditto

	* libedatacal/libedatacal-1.0.pc.in: use privincludedir; remove
	gal

2003-11-05  JP Rosevear <jpr@ximian.com>

	* libecal/Makefile.am: LIBADD all the relevant libical libs

	* libecal/libecal-1.0.pc.in: no need to explicitly link
	libical-evolution

	* libedatacal/libedatacal-1.0.pc.in: ditto; fix include dir
	
2003-11-05  Rodrigo Moya <rodrigo@ximian.com>

	* libedatacal/e-cal-backend-sexp.c: removed GAL dependency.

2003-11-04  JP Rosevear <jpr@ximian.com>

	* libedatacal/e-data-cal-factory.c: use properly name spaced
	default id

2003-11-04  JP Rosevear <jpr@ximian.com>

	* libecal/libecal-1.0.pc.in (prefix): include priv dir stuff for
	libical

	* libedatacal/libedatacal-1.0.pc.in (prefix): ditto
	
	* libecal/e-cal-component.[hc]: properly name space alarm action
	enum

	* libecal/e-cal-types.h: properly name space change types	
	
2003-11-04  JP Rosevear <jpr@ximian.com>

	* libedatacal/e-data-cal-factory.c: remove corba header include

	* libedatacal/e-cal-backend-sync.h: include corba header properly
	
	* libedatacal/e-data-cal.h: ditto

	* libedatacal/e-data-cal-view.h: ditto

	* libedatacal/e-data-cal-factory.h: ditto

	* libedatacal/e-cal-backend.h: ditto

	* libedatacal/Makefile.am: reflect idl name change

	* libecal/e-cal-listener.h: include corba header properly

	* libecal/e-cal-view.h: ditto

	* libecal/e-cal-view-listener.h: ditto

	* libecal/Makefile.am: reflect idl name change

	* idl/Makefile.am: rename the idl to Evolution-DataServer-Calendar.idl

2003-11-03  Hans Petter Jansson  <hpj@ximian.com>

	* calendar/libedatacal/e-cal-backend-file.c (free_calendar_components)
	(free_calendar_data): Implement.
	(e_cal_backend_file_dispose): Use above freers.
	(get_uri_string_for_gnome_vfs): Implement.
	(open_cal): Set priv->uri to be escaped, GnomeVFS-friendly.
	(notify_removals_cb)
	(notify_adds_modifies_cb)
	(notify_changes)
	(reload_cal): Implement.
	(create_cal): Set priv->uri to be escaped, GnomeVFS-friendly.
	(get_uri_string): Implement - unescapes once.
	(e_cal_backend_file_compute_changes): Unescape DB URI once, don't make
	like it's in a subdirectory.
	(e_cal_backend_file_reload): Implement.

	* calendar/libedatacal/e-cal-backend-http.c
	(e_cal_backend_http_finalize): Cancel potential retrieval and free
	slave backend.
	(e_cal_backend_http_is_read_only): Clean up.
	(webcal_to_http_method)
	(uri_to_cache_dir)
	(ensure_cache_dir)
	(retrieval_done)
	(retrieval_progress_cb)
	(begin_retrieval_cb): Implement.
	(e_cal_backend_http_open): Set up slave backend.
	(e_cal_backend_http_remove)
	(e_cal_backend_http_is_loaded)
	(e_cal_backend_http_get_default_object)
	(e_cal_backend_http_get_object)
	(e_cal_backend_http_get_timezone)
	(e_cal_backend_http_add_timezone)
	(e_cal_backend_http_set_default_timezone)
	(e_cal_backend_http_get_object_list)
	(e_cal_backend_http_get_free_busy)
	(e_cal_backend_http_get_changes)
	(e_cal_backend_http_discard_alarm)
	(e_cal_backend_http_modify_object)
	(e_cal_backend_http_remove_object)
	(e_cal_backend_http_receive_objects)
	(e_cal_backend_http_send_objects)
	(e_cal_backend_http_internal_get_default_timezone)
	(e_cal_backend_http_internal_get_timezone): Implement with fallthrough
	to slave backend.
	(e_cal_backend_http_init): Remove cruft.

	* calendar/libedatacal/e-cal-backend-sync.c
	(e_cal_backend_sync_open): Use per-instance mutex.
	(e_cal_backend_sync_init): Set up per-instance mutex.
	(e_cal_backend_sync_dispose): Free per-instance mutex.

	* calendar/libedatacal/e-cal-backend.c
	(e_cal_backend_set_notification_proxy): Implement.
	(e_cal_backend_notify_object_created)
	(e_cal_backend_notify_object_modified)
	(e_cal_backend_notify_object_removed)
	(e_cal_backend_notify_mode)
	(e_cal_backend_notify_error): Use notification proxy if set.
